// Build date: 2017-0425T12:36:05

/*
* Author   Jonathan Lurie - http://me.jonahanlurie.fr
* License  MIT
* Link      https://github.com/jonathanlurie/pixpipejs
* Lab       MCIN - Montreal Neurological Institute
*/
/*
 Chen, Yi-Cyuan 2014-2017
 @license MIT
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js  Based on ndef.parser, by Raphael Graf(r@undefined.ch)
 http://www.undefined.ch/mparser/index.html

 Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

 You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
 to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
 but don't feel like you have to let me know or ask permission.
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.inherits=function(h,t){function y(){}y.prototype=t.prototype;h.prototype=new y;h.prototype.constructor=h;for(var z in t)if(Object.defineProperties){var D=Object.getOwnPropertyDescriptor(t,z);D&&Object.defineProperty(h,z,D)}else h[z]=t[z]};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(h,t,y){if(y.get||y.set)throw new TypeError("ES3 does not support getters and setters.");h!=Array.prototype&&h!=Object.prototype&&(h[t]=y.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var h=$jscomp.global.Symbol.iterator;h||(h=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[h]&&$jscomp.defineProperty(Array.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(h){var t=0;return $jscomp.iteratorPrototype(function(){return t<h.length?{done:!1,value:h[t++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(h){$jscomp.initSymbolIterator();h={next:h};h[$jscomp.global.Symbol.iterator]=function(){return this};return h};$jscomp.iteratorFromArray=function(h,t){$jscomp.initSymbolIterator();h instanceof String&&(h+="");var y=0,z={next:function(){if(y<h.length){var D=y++;return{value:t(D,h[D]),done:!1}}z.next=function(){return{done:!0,value:void 0}};return z.next()}};z[Symbol.iterator]=function(){return z};return z};
$jscomp.polyfill=function(h,t,y,z){if(t){y=$jscomp.global;h=h.split(".");for(z=0;z<h.length-1;z++){var D=h[z];D in y||(y[D]={});y=y[D]}h=h[h.length-1];z=y[h];t=t(z);t!=z&&null!=t&&$jscomp.defineProperty(y,h,{configurable:!0,writable:!0,value:t})}};$jscomp.polyfill("Array.prototype.keys",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(h){return h})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(h){return h?h:function(h,y,z){var t=this.length||0;0>y&&(y=Math.max(0,t+y));if(null==z||z>t)z=t;z=Number(z);0>z&&(z=Math.max(0,t+z));for(y=Number(y||0);y<z;y++)this[y]=h;return this}},"es6-impl","es3");$jscomp.polyfill("Math.log2",function(h){return h?h:function(h){return Math.log(h)/Math.LN2}},"es6-impl","es3");
$jscomp.findInternal=function(h,t,y){h instanceof String&&(h=String(h));for(var z=h.length,D=0;D<z;D++){var S=h[D];if(t.call(y,S,D,h))return{i:D,v:S}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(h){return h?h:function(h,y){return $jscomp.findInternal(this,h,y).v}},"es6-impl","es3");$jscomp.polyfill("Math.sinh",function(h){if(h)return h;var t=Math.exp;return function(h){h=Number(h);return 0===h?h:(t(h)-t(-h))/2}},"es6-impl","es3");
$jscomp.polyfill("Math.cosh",function(h){if(h)return h;var t=Math.exp;return function(h){h=Number(h);return(t(h)+t(-h))/2}},"es6-impl","es3");$jscomp.polyfill("Math.tanh",function(h){return h?h:function(h){h=Number(h);if(0===h)return h;var t=Math.exp(-2*Math.abs(h)),t=(1-t)/(1+t);return 0>h?-t:t}},"es6-impl","es3");$jscomp.polyfill("Math.asinh",function(h){return h?h:function(h){h=Number(h);if(0===h)return h;var t=Math.log(Math.abs(h)+Math.sqrt(h*h+1));return 0>h?-t:t}},"es6-impl","es3");
$jscomp.polyfill("Math.acosh",function(h){return h?h:function(h){h=Number(h);return Math.log(h+Math.sqrt(h*h-1))}},"es6-impl","es3");$jscomp.polyfill("Math.log1p",function(h){return h?h:function(h){h=Number(h);if(.25>h&&-.25<h){for(var t=h,z=1,D=h,S=0,aa=1;S!=D;)t*=h,aa*=-1,D=(S=D)+aa*t/++z;return D}return Math.log(1+h)}},"es6-impl","es3");$jscomp.polyfill("Math.atanh",function(h){if(h)return h;var t=Math.log1p;return function(h){h=Number(h);return(t(h)-t(-h))/2}},"es6-impl","es3");
$jscomp.polyfill("Math.log10",function(h){return h?h:function(h){return Math.log(h)/Math.LN10}},"es6-impl","es3");$jscomp.polyfill("Math.trunc",function(h){return h?h:function(h){h=Number(h);if(isNaN(h)||Infinity===h||-Infinity===h||0===h)return h;var t=Math.floor(Math.abs(h));return 0>h?-t:t}},"es6-impl","es3");
$jscomp.polyfill("Math.hypot",function(h){return h?h:function(h,y,z){h=Number(h);y=Number(y);var t,S,aa,W=Math.max(Math.abs(h),Math.abs(y));for(t=2;t<arguments.length;t++)W=Math.max(W,Math.abs(arguments[t]));if(1E100<W||1E-100>W){h/=W;y/=W;aa=h*h+y*y;for(t=2;t<arguments.length;t++)S=Number(arguments[t])/W,aa+=S*S;return Math.sqrt(aa)*W}aa=h*h+y*y;for(t=2;t<arguments.length;t++)S=Number(arguments[t]),aa+=S*S;return Math.sqrt(aa)}},"es6-impl","es3");
(function(h,t){"object"===typeof exports&&"undefined"!==typeof module?t(exports):"function"===typeof define&&define.amd?define(["exports"],t):t(h.pixpipe=h.pixpipe||{})})(this,function(h){function t(){throw Error("setTimeout has not been defined");}function y(){throw Error("clearTimeout has not been defined");}function z(a){if(ea===setTimeout)return setTimeout(a,0);if((ea===t||!ea)&&setTimeout)return ea=setTimeout,setTimeout(a,0);try{return ea(a,0)}catch(b){try{return ea.call(null,a,0)}catch(c){return ea.call(this,
a,0)}}}function D(a){if(fa===clearTimeout)return clearTimeout(a);if((fa===y||!fa)&&clearTimeout)return fa=clearTimeout,clearTimeout(a);try{return fa(a)}catch(b){try{return fa.call(null,a)}catch(c){return fa.call(this,a)}}}function S(){xa&&ma&&(xa=!1,ma.length?ga=ma.concat(ga):Sa=-1,ga.length&&aa())}function aa(){if(!xa){var a=z(S);xa=!0;for(var b=ga.length;b;){ma=ga;for(ga=[];++Sa<b;)ma&&ma[Sa].run();Sa=-1;b=ga.length}ma=null;xa=!1;D(a)}}function W(a,b){this.fun=a;this.array=b}function na(){}function Ta(a,
b){return b={exports:{}},a(b,b.exports),b.exports}function Bb(){eb=!0;for(var a=0;64>a;++a)ba[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a],X["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;X[45]=62;X[95]=63}function Bc(a,b,c){for(var d=[],e=b;e<c;e+=3)b=(a[e]<<16)+(a[e+1]<<8)+a[e+2],d.push(ba[b>>18&63]+ba[b>>12&63]+ba[b>>6&63]+ba[b&63]);return d.join("")}function Cb(a){eb||Bb();for(var b=a.length,c=b%3,d="",e=[],f=0,g=b-c;f<g;f+=16383)e.push(Bc(a,
f,f+16383>g?g:f+16383));1===c?(a=a[b-1],d+=ba[a>>2],d+=ba[a<<4&63],d+="=="):2===c&&(a=(a[b-2]<<8)+a[b-1],d+=ba[a>>10],d+=ba[a>>4&63],d+=ba[a<<2&63],d+="=");e.push(d);return e.join("")}function Ua(a,b,c,d,e){var f;f=8*e-d-1;var g=(1<<f)-1,k=g>>1,m=-7;e=c?e-1:0;var l=c?-1:1,n=a[b+e];e+=l;c=n&(1<<-m)-1;n>>=-m;for(m+=f;0<m;c=256*c+a[b+e],e+=l,m-=8);f=c&(1<<-m)-1;c>>=-m;for(m+=d;0<m;f=256*f+a[b+e],e+=l,m-=8);if(0===c)c=1-k;else{if(c===g)return f?NaN:Infinity*(n?-1:1);f+=Math.pow(2,d);c-=k}return(n?-1:
1)*f*Math.pow(2,c-d)}function Db(a,b,c,d,e,f){var g,k=8*f-e-1,m=(1<<k)-1,l=m>>1,n=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;f=d?0:f-1;var h=d?1:-1,p=0>b||0===b&&0>1/b?1:0;b=Math.abs(b);isNaN(b)||Infinity===b?(b=isNaN(b)?1:0,d=m):(d=Math.floor(Math.log(b)/Math.LN2),1>b*(g=Math.pow(2,-d))&&(d--,g*=2),b=1<=d+l?b+n/g:b+n*Math.pow(2,1-l),2<=b*g&&(d++,g/=2),d+l>=m?(b=0,d=m):1<=d+l?(b=(b*g-1)*Math.pow(2,e),d+=l):(b=b*Math.pow(2,l-1)*Math.pow(2,e),d=0));for(;8<=e;a[c+f]=b&255,f+=h,b/=256,e-=8);d=d<<e|b;for(k+=
e;0<k;a[c+f]=d&255,f+=h,d/=256,k-=8);a[c+f-h]|=128*p}function ca(a,b){if((p.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<b)throw new RangeError("Invalid typed array length");p.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(b),a.__proto__=p.prototype):(null===a&&(a=new p(b)),a.length=b);return a}function p(a,b,c){if(!(p.TYPED_ARRAY_SUPPORT||this instanceof p))return new p(a,b,c);if("number"===typeof a){if("string"===typeof b)throw Error("If encoding is specified then the first argument must be a string");return fb(this,
a)}return Eb(this,a,b,c)}function Eb(a,b,c,d){if("number"===typeof b)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&b instanceof ArrayBuffer){b.byteLength;if(0>c||b.byteLength<c)throw new RangeError("'offset' is out of bounds");if(b.byteLength<c+(d||0))throw new RangeError("'length' is out of bounds");b=void 0===c&&void 0===d?new Uint8Array(b):void 0===d?new Uint8Array(b,c):new Uint8Array(b,c,d);p.TYPED_ARRAY_SUPPORT?(a=b,a.__proto__=p.prototype):
a=gb(a,b);return a}if("string"===typeof b){d=a;a=c;if("string"!==typeof a||""===a)a="utf8";if(!p.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');c=Fb(b,a)|0;d=ca(d,c);b=d.write(b,a);b!==c&&(d=d.slice(0,b));return d}return Cc(a,b)}function Gb(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function fb(a,b){Gb(b);a=ca(a,0>b?0:hb(b)|0);if(!p.TYPED_ARRAY_SUPPORT)for(var c=
0;c<b;++c)a[c]=0;return a}function gb(a,b){var c=0>b.length?0:hb(b.length)|0;a=ca(a,c);for(var d=0;d<c;d+=1)a[d]=b[d]&255;return a}function Cc(a,b){if(Y(b)){var c=hb(b.length)|0;a=ca(a,c);if(0===a.length)return a;b.copy(a,0,0,c);return a}if(b){if("undefined"!==typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer||"length"in b)return(c="number"!==typeof b.length)||(c=b.length,c=c!==c),c?ca(a,0):gb(a,b);if("Buffer"===b.type&&Hb(b.data))return gb(a,b.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function hb(a){if(a>=(p.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(p.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function Y(a){return!(null==a||!a._isBuffer)}function Fb(a,b){if(Y(a))return a.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!==typeof a&&(a=""+a);var c=a.length;
if(0===c)return 0;for(var d=!1;;)switch(b){case "ascii":case "latin1":case "binary":return c;case "utf8":case "utf-8":case void 0:return Va(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*c;case "hex":return c>>>1;case "base64":return Ib(a).length;default:if(d)return Va(a).length;b=(""+b).toLowerCase();d=!0}}function Dc(a,b,c){var d=!1;if(void 0===b||0>b)b=0;if(b>this.length)return"";if(void 0===c||c>this.length)c=this.length;if(0>=c)return"";c>>>=0;b>>>=0;if(c<=b)return"";
for(a||(a="utf8");;)switch(a){case "hex":a=b;b=c;c=this.length;if(!a||0>a)a=0;if(!b||0>b||b>c)b=c;d="";for(c=a;c<b;++c)a=d,d=this[c],d=16>d?"0"+d.toString(16):d.toString(16),d=a+d;return d;case "utf8":case "utf-8":return Jb(this,b,c);case "ascii":a="";for(c=Math.min(this.length,c);b<c;++b)a+=String.fromCharCode(this[b]&127);return a;case "latin1":case "binary":a="";for(c=Math.min(this.length,c);b<c;++b)a+=String.fromCharCode(this[b]);return a;case "base64":return b=0===b&&c===this.length?Cb(this):
Cb(this.slice(b,c)),b;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":b=this.slice(b,c);c="";for(a=0;a<b.length;a+=2)c+=String.fromCharCode(b[a]+256*b[a+1]);return c;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}}function oa(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function Kb(a,b,c,d,e){if(0===a.length)return-1;"string"===typeof c?(d=c,c=0):2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648);c=+c;isNaN(c)&&(c=e?0:a.length-1);0>c&&(c=a.length+c);if(c>=
a.length){if(e)return-1;c=a.length-1}else if(0>c)if(e)c=0;else return-1;"string"===typeof b&&(b=p.from(b,d));if(Y(b))return 0===b.length?-1:Lb(a,b,c,d,e);if("number"===typeof b)return b&=255,p.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):Lb(a,[b],c,d,e);throw new TypeError("val must be string, number or Buffer");}function Lb(a,b,c,d,e){function f(a,c){return 1===g?a[c]:a.readUInt16BE(c*
g)}var g=1,k=a.length,m=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>a.length||2>b.length)return-1;g=2;k/=2;m/=2;c/=2}if(e)for(d=-1;c<k;c++)if(f(a,c)===f(b,-1===d?0:c-d)){if(-1===d&&(d=c),c-d+1===m)return d*g}else-1!==d&&(c-=c-d),d=-1;else for(c+m>k&&(c=k-m);0<=c;c--){k=!0;for(d=0;d<m;d++)if(f(a,c+d)!==f(b,d)){k=!1;break}if(k)return c}return-1}function Jb(a,b,c){c=Math.min(a.length,c);for(var d=[];b<c;){var e=a[b],f=null,g=239<e?
4:223<e?3:191<e?2:1;if(b+g<=c){var k,m,l;switch(g){case 1:128>e&&(f=e);break;case 2:k=a[b+1];128===(k&192)&&(e=(e&31)<<6|k&63,127<e&&(f=e));break;case 3:k=a[b+1];m=a[b+2];128===(k&192)&&128===(m&192)&&(e=(e&15)<<12|(k&63)<<6|m&63,2047<e&&(55296>e||57343<e)&&(f=e));break;case 4:k=a[b+1],m=a[b+2],l=a[b+3],128===(k&192)&&128===(m&192)&&128===(l&192)&&(e=(e&15)<<18|(k&63)<<12|(m&63)<<6|l&63,65535<e&&1114112>e&&(f=e))}}null===f?(f=65533,g=1):65535<f&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|f&1023);
d.push(f);b+=g}a=d.length;if(a<=Mb)d=String.fromCharCode.apply(String,d);else{c="";for(b=0;b<a;)c+=String.fromCharCode.apply(String,d.slice(b,b+=Mb));d=c}return d}function I(a,b,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function T(a,b,c,d,e,f){if(!Y(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw new RangeError('"value" argument is out of bounds');if(c+d>a.length)throw new RangeError("Index out of range");
}function Wa(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;++e)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function Xa(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;++e)a[c+e]=b>>>8*(d?e:3-e)&255}function Nb(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range");}function Ob(a,b,c,d,e){e||Nb(a,b,c,4,3.4028234663852886E38,-3.4028234663852886E38);Db(a,b,c,d,23,4);return c+4}function Pb(a,
b,c,d,e){e||Nb(a,b,c,8,1.7976931348623157E308,-1.7976931348623157E308);Db(a,b,c,d,52,8);return c+8}function Va(a,b){b=b||Infinity;for(var c,d=a.length,e=null,f=[],g=0;g<d;++g){c=a.charCodeAt(g);if(55295<c&&57344>c){if(!e){if(56319<c){-1<(b-=3)&&f.push(239,191,189);continue}else if(g+1===d){-1<(b-=3)&&f.push(239,191,189);continue}e=c;continue}if(56320>c){-1<(b-=3)&&f.push(239,191,189);e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&-1<(b-=3)&&f.push(239,191,189);e=null;if(128>c){if(0>--b)break;
f.push(c)}else if(2048>c){if(0>(b-=2))break;f.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(b-=3))break;f.push(c>>12|224,c>>6&63|128,c&63|128)}else if(1114112>c){if(0>(b-=4))break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return f}function Qb(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c)&255);return b}function Ib(a){a=(a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")).replace(Ec,"");if(2>a.length)a="";else for(;0!==a.length%4;)a+="=";eb||Bb();
var b,c,d,e,f;b=a.length;if(0<b%4)throw Error("Invalid string. Length must be a multiple of 4");e="="===a[b-2]?2:"="===a[b-1]?1:0;f=new Fc(3*b/4-e);c=0<e?b-4:b;var g=0;for(b=0;b<c;b+=4)d=X[a.charCodeAt(b)]<<18|X[a.charCodeAt(b+1)]<<12|X[a.charCodeAt(b+2)]<<6|X[a.charCodeAt(b+3)],f[g++]=d>>16&255,f[g++]=d>>8&255,f[g++]=d&255;2===e?(d=X[a.charCodeAt(b)]<<2|X[a.charCodeAt(b+1)]>>4,f[g++]=d&255):1===e&&(d=X[a.charCodeAt(b)]<<10|X[a.charCodeAt(b+1)]<<4|X[a.charCodeAt(b+2)]>>2,f[g++]=d>>8&255,f[g++]=d&
255);return f}function Da(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function Rb(a){return null!=a&&(!!a._isBuffer||Sb(a)||"function"===typeof a.readFloatLE&&"function"===typeof a.slice&&Sb(a.slice(0,0)))}function Sb(a){return!!a.constructor&&"function"===typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function ya(a){for(var b=a.length;0<=--b;)a[b]=0}function ib(a,b,c,d,e){this.static_tree=a;this.extra_bits=b;this.extra_base=c;this.elems=d;this.max_length=
e;this.has_stree=a&&a.length}function jb(a,b){this.dyn_tree=a;this.max_code=0;this.stat_desc=b}function Ea(a,b){a.pending_buf[a.pending++]=b&255;a.pending_buf[a.pending++]=b>>>8&255}function U(a,b,c){a.bi_valid>16-c?(a.bi_buf|=b<<a.bi_valid&65535,Ea(a,a.bi_buf),a.bi_buf=b>>16-a.bi_valid,a.bi_valid+=c-16):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function N(a,b,c){U(a,c[2*b],c[2*b+1])}function Tb(a,b){var c=0;do c|=a&1,a>>>=1,c<<=1;while(0<--b);return c>>>1}function Ub(a,b,c){var d=Array(16),e=
0,f;for(f=1;15>=f;f++)d[f]=e=e+c[f-1]<<1;for(c=0;c<=b;c++)e=a[2*c+1],0!==e&&(a[2*c]=Tb(d[e]++,e))}function Vb(a){var b;for(b=0;286>b;b++)a.dyn_ltree[2*b]=0;for(b=0;30>b;b++)a.dyn_dtree[2*b]=0;for(b=0;19>b;b++)a.bl_tree[2*b]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function Wb(a){8<a.bi_valid?Ea(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf);a.bi_buf=0;a.bi_valid=0}function Xb(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function kb(a,
b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len;){e<a.heap_len&&Xb(b,a.heap[e+1],a.heap[e],a.depth)&&e++;if(Xb(b,d,a.heap[e],a.depth))break;a.heap[c]=a.heap[e];c=e;e<<=1}a.heap[c]=d}function Yb(a,b,c){var d,e,f=0,g,k;if(0!==a.last_lit){do d=a.pending_buf[a.d_buf+2*f]<<8|a.pending_buf[a.d_buf+2*f+1],e=a.pending_buf[a.l_buf+f],f++,0===d?N(a,e,b):(g=Fa[e],N(a,g+256+1,b),k=lb[g],0!==k&&(e-=mb[g],U(a,e,k)),d--,g=256>d?pa[d]:pa[256+(d>>>7)],N(a,g,c),k=Ya[g],0!==k&&(d-=Za[g],U(a,d,k)));while(f<a.last_lit)
}N(a,256,b)}function nb(a,b){var c=b.dyn_tree,d=b.stat_desc.static_tree,e=b.stat_desc.has_stree,f=b.stat_desc.elems,g,k=-1,m;a.heap_len=0;a.heap_max=573;for(g=0;g<f;g++)0!==c[2*g]?(a.heap[++a.heap_len]=k=g,a.depth[g]=0):c[2*g+1]=0;for(;2>a.heap_len;)m=a.heap[++a.heap_len]=2>k?++k:0,c[2*m]=1,a.depth[m]=0,a.opt_len--,e&&(a.static_len-=d[2*m+1]);b.max_code=k;for(g=a.heap_len>>1;1<=g;g--)kb(a,c,g);m=f;do g=a.heap[1],a.heap[1]=a.heap[a.heap_len--],kb(a,c,1),d=a.heap[1],a.heap[--a.heap_max]=g,a.heap[--a.heap_max]=
d,c[2*m]=c[2*g]+c[2*d],a.depth[m]=(a.depth[g]>=a.depth[d]?a.depth[g]:a.depth[d])+1,c[2*g+1]=c[2*d+1]=m,a.heap[1]=m++,kb(a,c,1);while(2<=a.heap_len);a.heap[--a.heap_max]=a.heap[1];g=b.dyn_tree;m=b.max_code;for(var l=b.stat_desc.static_tree,n=b.stat_desc.has_stree,h=b.stat_desc.extra_bits,p=b.stat_desc.extra_base,q=b.stat_desc.max_length,r,u,$a=0,f=0;15>=f;f++)a.bl_count[f]=0;g[2*a.heap[a.heap_max]+1]=0;for(d=a.heap_max+1;573>d;d++)e=a.heap[d],f=g[2*g[2*e+1]+1]+1,f>q&&(f=q,$a++),g[2*e+1]=f,e>m||(a.bl_count[f]++,
r=0,e>=p&&(r=h[e-p]),u=g[2*e],a.opt_len+=u*(f+r),n&&(a.static_len+=u*(l[2*e+1]+r)));if(0!==$a){do{for(f=q-1;0===a.bl_count[f];)f--;a.bl_count[f]--;a.bl_count[f+1]+=2;a.bl_count[q]--;$a-=2}while(0<$a);for(f=q;0!==f;f--)for(e=a.bl_count[f];0!==e;)l=a.heap[--d],l>m||(g[2*l+1]!==f&&(a.opt_len+=(f-g[2*l+1])*g[2*l],g[2*l+1]=f),e--)}Ub(c,k,a.bl_count)}function Zb(a,b,c){var d,e=-1,f,g=b[1],k=0,m=7,l=4;0===g&&(m=138,l=3);b[2*(c+1)+1]=65535;for(d=0;d<=c;d++)f=g,g=b[2*(d+1)+1],++k<m&&f===g||(k<l?a.bl_tree[2*
f]+=k:0!==f?(f!==e&&a.bl_tree[2*f]++,a.bl_tree[32]++):10>=k?a.bl_tree[34]++:a.bl_tree[36]++,k=0,e=f,0===g?(m=138,l=3):f===g?(m=6,l=3):(m=7,l=4))}function $b(a,b,c){var d,e=-1,f,g=b[1],k=0,m=7,l=4;0===g&&(m=138,l=3);for(d=0;d<=c;d++)if(f=g,g=b[2*(d+1)+1],!(++k<m&&f===g)){if(k<l){do N(a,f,a.bl_tree);while(0!==--k)}else 0!==f?(f!==e&&(N(a,f,a.bl_tree),k--),N(a,16,a.bl_tree),U(a,k-3,2)):10>=k?(N(a,17,a.bl_tree),U(a,k-3,3)):(N(a,18,a.bl_tree),U(a,k-11,7));k=0;e=f;0===g?(m=138,l=3):f===g?(m=6,l=3):(m=7,
l=4)}}function Gc(a){var b=4093624447,c;for(c=0;31>=c;c++,b>>>=1)if(b&1&&0!==a.dyn_ltree[2*c])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;for(c=32;256>c;c++)if(0!==a.dyn_ltree[2*c])return 1;return 0}function ac(a,b,c,d){U(a,0+(d?1:0),3);Wb(a);Ea(a,c);Ea(a,~c);B.arraySet(a.pending_buf,a.window,b,c,a.pending);a.pending+=c}function ha(a,b){a.msg=za[b];return b}function ja(a){for(var b=a.length;0<=--b;)a[b]=0}function ka(a){var b=a.state,c=b.pending;c>a.avail_out&&
(c=a.avail_out);0!==c&&(B.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function J(a,b){Z._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,b);a.block_start=a.strstart;ka(a.strm)}function x(a,b){a.pending_buf[a.pending++]=b}function Ga(a,b){a.pending_buf[a.pending++]=b>>>8&255;a.pending_buf[a.pending++]=b&255}function bc(a,b){var c=a.max_chain_length,
d=a.strstart,e,f=a.prev_length,g=a.nice_match,k=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,m=a.window,l=a.w_mask,n=a.prev,h=a.strstart+258,p=m[d+f-1],q=m[d+f];a.prev_length>=a.good_match&&(c>>=2);g>a.lookahead&&(g=a.lookahead);do if(e=b,m[e+f]===q&&m[e+f-1]===p&&m[e]===m[d]&&m[++e]===m[d+1]){d+=2;for(e++;m[++d]===m[++e]&&m[++d]===m[++e]&&m[++d]===m[++e]&&m[++d]===m[++e]&&m[++d]===m[++e]&&m[++d]===m[++e]&&m[++d]===m[++e]&&m[++d]===m[++e]&&d<h;);e=258-(h-d);d=h-258;if(e>f){a.match_start=b;
f=e;if(e>=g)break;p=m[d+f-1];q=m[d+f]}}while((b=n[b&l])>k&&0!==--c);return f<=a.lookahead?f:a.lookahead}function qa(a){var b=a.w_size,c,d,e,f;do{f=a.window_size-a.lookahead-a.strstart;if(a.strstart>=b+(b-262)){B.arraySet(a.window,a.window,b,b,0);a.match_start-=b;a.strstart-=b;a.block_start-=b;c=d=a.hash_size;do e=a.head[--c],a.head[c]=e>=b?e-b:0;while(--d);c=d=b;do e=a.prev[--c],a.prev[c]=e>=b?e-b:0;while(--d);f+=b}if(0===a.strm.avail_in)break;c=a.strm;d=a.window;e=a.strstart+a.lookahead;var g=c.avail_in;
g>f&&(g=f);0===g?d=0:(c.avail_in-=g,B.arraySet(d,c.input,c.next_in,g,e),1===c.state.wrap?c.adler=Ha(c.adler,d,g,e):2===c.state.wrap&&(c.adler=K(c.adler,d,g,e)),c.next_in+=g,c.total_in+=g,d=g);a.lookahead+=d;if(3<=a.lookahead+a.insert)for(f=a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&!(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+3-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,3>a.lookahead+a.insert););
}while(262>a.lookahead&&0!==a.strm.avail_in)}function ob(a,b){for(var c;;){if(262>a.lookahead){qa(a);if(262>a.lookahead&&0===b)return 1;if(0===a.lookahead)break}c=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);0!==c&&a.strstart-c<=a.w_size-262&&(a.match_length=bc(a,c));if(3<=a.match_length)if(c=Z._tr_tally(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=
a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else c=Z._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(c&&(J(a,!1),0===a.strm.avail_out))return 1}a.insert=
2>a.strstart?a.strstart:2;return 4===b?(J(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(J(a,!1),0===a.strm.avail_out)?1:2}function Aa(a,b){for(var c,d;;){if(262>a.lookahead){qa(a);if(262>a.lookahead&&0===b)return 1;if(0===a.lookahead)break}c=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);a.prev_length=a.match_length;a.prev_match=a.match_start;a.match_length=2;0!==c&&a.prev_length<a.max_lazy_match&&
a.strstart-c<=a.w_size-262&&(a.match_length=bc(a,c),5>=a.match_length&&(1===a.strategy||3===a.match_length&&4096<a.strstart-a.match_start)&&(a.match_length=2));if(3<=a.prev_length&&a.match_length<=a.prev_length){d=a.strstart+a.lookahead-3;c=Z._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-3);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=d&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);
while(0!==--a.prev_length);a.match_available=0;a.match_length=2;a.strstart++;if(c&&(J(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if((c=Z._tr_tally(a,0,a.window[a.strstart-1]))&&J(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}a.match_available&&(Z._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0);a.insert=2>a.strstart?a.strstart:2;return 4===b?(J(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(J(a,!1),0===
a.strm.avail_out)?1:2}function Hc(a,b){for(var c,d,e,f=a.window;;){if(258>=a.lookahead){qa(a);if(258>=a.lookahead&&0===b)return 1;if(0===a.lookahead)break}a.match_length=0;if(3<=a.lookahead&&0<a.strstart&&(d=a.strstart-1,c=f[d],c===f[++d]&&c===f[++d]&&c===f[++d])){for(e=a.strstart+258;c===f[++d]&&c===f[++d]&&c===f[++d]&&c===f[++d]&&c===f[++d]&&c===f[++d]&&c===f[++d]&&c===f[++d]&&d<e;);a.match_length=258-(e-d);a.match_length>a.lookahead&&(a.match_length=a.lookahead)}3<=a.match_length?(c=Z._tr_tally(a,
1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=Z._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++);if(c&&(J(a,!1),0===a.strm.avail_out))return 1}a.insert=0;return 4===b?(J(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(J(a,!1),0===a.strm.avail_out)?1:2}function Ic(a,b){for(var c;;){if(0===a.lookahead&&(qa(a),0===a.lookahead)){if(0===b)return 1;break}a.match_length=0;c=Z._tr_tally(a,0,a.window[a.strstart]);a.lookahead--;a.strstart++;if(c&&
(J(a,!1),0===a.strm.avail_out))return 1}a.insert=0;return 4===b?(J(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(J(a,!1),0===a.strm.avail_out)?1:2}function da(a,b,c,d,e){this.good_length=a;this.max_lazy=b;this.nice_length=c;this.max_chain=d;this.func=e}function Jc(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;
this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new B.Buf16(1146);this.dyn_dtree=new B.Buf16(122);this.bl_tree=new B.Buf16(78);ja(this.dyn_ltree);ja(this.dyn_dtree);ja(this.bl_tree);
this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new B.Buf16(16);this.heap=new B.Buf16(573);ja(this.heap);this.heap_max=this.heap_len=0;this.depth=new B.Buf16(573);ja(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function cc(a){var b;if(!a||!a.state)return ha(a,-2);a.total_in=a.total_out=0;a.data_type=2;b=a.state;b.pending=0;b.pending_out=0;0>b.wrap&&(b.wrap=-b.wrap);b.status=b.wrap?42:113;
a.adler=2===b.wrap?0:1;b.last_flush=0;Z._tr_init(b);return 0}function dc(a){var b=cc(a);0===b&&(a=a.state,a.window_size=2*a.w_size,ja(a.head),a.max_lazy_match=Ba[a.level].max_lazy,a.good_match=Ba[a.level].good_length,a.nice_match=Ba[a.level].nice_length,a.max_chain_length=Ba[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0);return b}function ec(a,b,c,d,e,f){if(!a)return-2;var g=1;-1===b&&(b=6);0>d?(g=0,d=-d):15<d&&
(g=2,d-=16);if(1>e||9<e||8!==c||8>d||15<d||0>b||9<b||0>f||4<f)return ha(a,-2);8===d&&(d=9);var k=new Jc;a.state=k;k.strm=a;k.wrap=g;k.gzhead=null;k.w_bits=d;k.w_size=1<<k.w_bits;k.w_mask=k.w_size-1;k.hash_bits=e+7;k.hash_size=1<<k.hash_bits;k.hash_mask=k.hash_size-1;k.hash_shift=~~((k.hash_bits+3-1)/3);k.window=new B.Buf8(2*k.w_size);k.head=new B.Buf16(k.hash_size);k.prev=new B.Buf16(k.w_size);k.lit_bufsize=1<<e+6;k.pending_buf_size=4*k.lit_bufsize;k.pending_buf=new B.Buf8(k.pending_buf_size);k.d_buf=
1*k.lit_bufsize;k.l_buf=3*k.lit_bufsize;k.level=b;k.strategy=f;k.method=c;return dc(a)}function fc(a,b){if(65537>b&&(a.subarray&&gc||!a.subarray&&hc))return String.fromCharCode.apply(null,B.shrinkBuf(a,b));for(var c="",d=0;d<b;d++)c+=String.fromCharCode(a[d]);return c}function ra(a){if(!(this instanceof ra))return new ra(a);a=this.options=B.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},a||{});a.raw&&0<a.windowBits?a.windowBits=-a.windowBits:a.gzip&&0<a.windowBits&&
16>a.windowBits&&(a.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new ic;this.strm.avail_out=0;var b=Ia.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(0!==b)throw Error(za[b]);a.header&&Ia.deflateSetHeader(this.strm,a.header);if(a.dictionary){a="string"===typeof a.dictionary?sa.string2buf(a.dictionary):"[object ArrayBuffer]"===jc.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary;b=Ia.deflateSetDictionary(this.strm,a);if(0!==
b)throw Error(za[b]);this._dict_set=!0}}function pb(a,b){var c=new ra(b);c.push(a,!0);if(c.err)throw c.msg||za[c.err];return c.result}function kc(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function Kc(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=
this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new B.Buf16(320);this.work=new B.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function lc(a){var b;if(!a||!a.state)return-2;b=a.state;a.total_in=a.total_out=b.total=0;a.msg="";b.wrap&&(a.adler=b.wrap&1);b.mode=1;b.last=0;b.havedict=0;b.dmax=32768;b.head=null;b.hold=0;b.bits=0;b.lencode=b.lendyn=new B.Buf32(852);b.distcode=b.distdyn=new B.Buf32(592);b.sane=1;b.back=-1;return 0}function mc(a){var b;
if(!a||!a.state)return-2;b=a.state;b.wsize=0;b.whave=0;b.wnext=0;return lc(a)}function nc(a,b){var c,d;if(!a||!a.state)return-2;d=a.state;0>b?(c=0,b=-b):(c=(b>>4)+1,48>b&&(b&=15));if(b&&(8>b||15<b))return-2;null!==d.window&&d.wbits!==b&&(d.window=null);d.wrap=c;d.wbits=b;return mc(a)}function oc(a,b){var c;if(!a)return-2;c=new Kc;a.state=c;c.window=null;c=nc(a,b);0!==c&&(a.state=null);return c}function pc(a,b,c,d){var e=a.state;null===e.window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new B.Buf8(e.wsize));
d>=e.wsize?(B.arraySet(e.window,b,c-e.wsize,e.wsize,0),e.wnext=0,e.whave=e.wsize):(a=e.wsize-e.wnext,a>d&&(a=d),B.arraySet(e.window,b,c-d,a,e.wnext),(d-=a)?(B.arraySet(e.window,b,c-d,d,0),e.wnext=d,e.whave=e.wsize):(e.wnext+=a,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=a)));return 0}function ta(a){if(!(this instanceof ta))return new ta(a);var b=this.options=B.assign({chunkSize:16384,windowBits:0,to:""},a||{});b.raw&&0<=b.windowBits&&16>b.windowBits&&(b.windowBits=-b.windowBits,0===
b.windowBits&&(b.windowBits=-15));!(0<=b.windowBits&&16>b.windowBits)||a&&a.windowBits||(b.windowBits+=32);15<b.windowBits&&48>b.windowBits&&0===(b.windowBits&15)&&(b.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new ic;this.strm.avail_out=0;a=Ja.inflateInit2(this.strm,b.windowBits);if(a!==G.Z_OK)throw Error(za[a]);this.header=new Lc;Ja.inflateGetHeader(this.strm,this.header)}function qb(a,b){var c=new ta(b);c.push(a,!0);if(c.err)throw c.msg||za[c.err];return c.result}
var E=function(){this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});this._metadata={};this._type=E.TYPE()};E.TYPE=function(){return"GENERIC"};E.prototype.isOfType=function(a){return!this._type.localeCompare(a)};E.prototype.getType=function(){this._type};E.prototype.getUuid=function(){return this._uuid.slice()};E.prototype.setMetadata=function(a,b){"string"===typeof a||a instanceof String?this._metadata[a]=b:
console.warn("The given key must be a String Object.")};E.prototype.getMetadata=function(a){if(a in this._metadata)return this._metadata[a];console.warn("The metadata with key: "+a+" doe not exist.");return null};E.prototype.hasMetadata=function(a){return a in this._metadata};E.prototype.getMetadataKeys=function(){return Object.keys(this._metadata)};E.prototype.copyMetadataFrom=function(a){var b=this;a.getMetadataKeys().forEach(function(c){try{var d=JSON.parse(JSON.stringify(a.getMetadata(c)));b.setMetadata(c,
d)}catch(e){console.error(e)}})};E.prototype.getMetadataCopy=function(){return JSON.parse(JSON.stringify(this._metadata))};var A=function(){var a;a=E.call(this)||this;a._type=A.TYPE();a._events={};a._inputValidator={};a._input={};a._output={};a._timer={};a._isOutputReady=!1;return a};$jscomp.inherits(A,E);A.TYPE=function(){return"FILTER"};A.prototype.addInput=function(a,b){b=void 0===b?0:b;b in this._input||(this._input[b]=null);this._input[b]=a;this._isOutputReady=!1};A.prototype.getOutput=function(a){a=
void 0===a?0:a;return a in this._output?this._output[a]:null};A.prototype.forEachOutput=function(a){if(a)for(var b=this.getOutputCategories(),c=0;c<b.length;c++)a(b[c],this.getOutput(b[c]));else console.warn("forEachOutput requires a callback.")};A.prototype._forEachInput=function(a){if(a)for(var b=this.getInputCategories(),c=0;c<b.length;c++)a(b[c],this._getInput(b[c]));else console.warn("forEachOutput requires a callback.")};A.prototype._addOutput=function(a,b){b=void 0===b?0:b;var c=null;b in this._output?
console.warn("An output of category "+b+" was already defined. Nothing to be done."):(c=new a,this._output[b]=c,console.log("filter "+this.constructor.name+" creates a new output."));return c};A.prototype._getInput=function(a){a=void 0===a?0:a;return a in this._input?this._input[a]:null};A.prototype.hasInputOfCategory=function(a){return a in this._input};A.prototype.getInputCategories=function(){return Object.keys(this._input)};A.prototype.getOutputCategories=function(){return Object.keys(this._output)};
A.prototype.setMetadata=function(a,b){E.prototype.setMetadata.call(this,a,b);this._isOutputReady=!1};A.prototype.hasOutputReady=function(){return this._isOutputReady};A.prototype.setOutputAsReady=function(){this._isOutputReady=!0};A.prototype.addInputValidator=function(a,b){this._inputValidator[a]=b.TYPE()};A.prototype.hasValidInput=function(){var a=this,b=Object.keys(this._inputValidator),c=!0;0==b.length&&(c=!1,console.warn("No input validator was added. Filter cannot run. Use addInputValidator(...) to specify input types."));
b.forEach(function(b){c=c&&a._getInput(b).isOfType(a._inputValidator[b])});c||console.warn("The input is not valid.");return c};A.prototype.update=function(){this.addTimeRecord("begin");this._run();this.addTimeRecord("end");console.log("Running time for filter "+this.constructor.name+": "+this.getTime("begin","end")+"ms.");this.getNumberOfOutputs()&&this.setOutputAsReady()};A.prototype._run=function(){console.error("The update() method has not been written, this filter is not valid.")};A.prototype.addTimeRecord=
function(a){this._timer[a]=performance.now()};A.prototype.getTime=function(a,b,c){c=void 0===c?!1:c;if(a in this._timer&&b in this._timer){var d=Math.abs(this._timer[b]-this._timer[a]);c&&console.log("> Time: ["+a+" , "+b+"] is "+d+" millisec.");return d}console.warn("The two given record name must exist in the time record table.");return-1};A.prototype.on=function(a,b){this._events[a]=b};A.prototype.getNumberOfInputs=function(){return Object.keys(this._input).length};A.prototype.getNumberOfOutputs=
function(){return Object.keys(this._output).length};var ua=function(){var a;a=E.call(this)||this;a._data=null;return a};$jscomp.inherits(ua,E);ua.prototype.setRawData=function(a){this._data=a};ua.prototype.setRawMetadata=function(a){this._metadata=a};var C=function(a){var b;a=void 0===a?null:a;b=ua.call(this)||this;b._type=C.TYPE();b.setMetadata("ncpp",4);if(a&&"width"in a&&"height"in a&&0<a.width&&0<a.height){b.setMetadata("width",a.width);b.setMetadata("height",a.height);"color"in a&&b.setMetadata("ncpp",
a.color.length);b._data=new Float32Array(a.width*a.height*b.getMetadata("ncpp"));var c=b.getMetadata("ncpp");if("color"in a){a=a.color;for(var d=0;d<b._data.length;d++)b._data[d]=a[d%c];b.computeSimpleStat()}else b._data.fill(0)}return b};$jscomp.inherits(C,ua);C.TYPE=function(){return"IMAGE2D"};C.prototype.clone=function(){var a=new C;a.setData(this._data,this.getMetadata("width"),this.getMetadata("height"),this.getMetadata("ncpp"),!0);a.copyMetadataFrom(this);return a};C.prototype.setData=function(a,
b,c,d,e){d=void 0===d?4:d;e=void 0===e?!1:e;this.setMetadata("ncpp",d);a.length!=b*c*d?console.warn("The array size does not match the width and height. Cannot init the Image2D."):(this._data=e?new a.constructor(a):a,this.setMetadata("width",b),this.setMetadata("height",c),this.computeSimpleStat())};C.prototype.setPixel=function(a,b,c){c=void 0===c?!1:c;if(this._data){var d=this._metadata.ncpp;if("x"in a&&0<=a.x&&a.x<this._metadata.width&&"y"in a&&0<=a.y&&a.y<this._metadata.height&&b.length==d){a=
this.get1dIndexFrom2dPosition(a);if(1==d)this._data[a]=b[0];else{a*=d;for(var e=0;e<d;e++)this._data[a+e]=b[e]}c&&this.computeSimpleStat()}else console.error("x and y position have to be within the image dimensions and color size must be the same as the original image.")}else console.warn("The image is empty")};C.prototype.getPixel=function(a){if(this._data){if("x"in a&&0<=a.x&&a.x<this._metadata.width&&"y"in a&&0<=a.y&&a.y<this._metadata.height){var b=this._metadata.ncpp;a=this.get1dIndexFrom2dPosition(a);
1==b?b=[this._data[a]]:(a*=b,b=this._data.slice(a,a+b));return b}console.warn("The requested position is outside the image.");return null}console.warn("The image is empty")};C.prototype.getWidth=function(){return this._metadata.width};C.prototype.getHeight=function(){return this._metadata.height};C.prototype.getComponentsPerPixel=function(){return this._metadata.ncpp};C.prototype.getData=function(){return this._data};C.prototype.getDataCopy=function(){return new this._data.constructor(this._data)};
C.prototype.getDataAsUInt8Array=function(){if(this._data){for(var a=this.getMin(),b=this.getMax(),c=new Uint8Array(this._data.length),d=0;d<this._data.length;d++)c[d]=(this._data[d]-a)/b*256;return c}console.warn("No data, cannot make a copy of it.")};C.prototype.get2dPositionFrom1dIndex=function(a){return{x:a%this._metadata.width,y:Math.floor(a/this._metadata.width)}};C.prototype.get1dIndexFrom2dPosition=function(a){return a.x+a.y*this._metadata.width};C.prototype.computeSimpleStat=function(){if(this._data){for(var a=
Infinity,b=-Infinity,c=0,d=0;d<this._data.length;d++)a=Math.min(a,this._data[d]),b=Math.max(a,this._data[d]),c+=this._data[d];this.setMetadata("min",a);this.setMetadata("max",b);this.setMetadata("avg",c/this._data.length)}else console.warn("The image is empty")};C.prototype.getMin=function(){this.hasMetadata("min")||this.computeSimpleStat();return this.getMetadata("min")};C.prototype.getMax=function(){this.hasMetadata("max")||this.computeSimpleStat();return this.getMetadata("max")};C.prototype.getAvg=
function(){this.hasMetadata("avg")||this.computeSimpleStat();return this.getMetadata("avg")};var H=function(a){var b;a=void 0===a?null:a;b=ua.call(this)||this;b._type=H.TYPE();b.setMetadata("ncpp",1);a&&"order"in a?b.setMetadata("order",a.order):b.setMetadata("order",["zspace","yspace","xspace"]);var c={offset:1,step:1},d={step:1},e={step:1};b.setMetadata("xspace",c);b.setMetadata("yspace",d);b.setMetadata("zspace",e);a&&"ncpp"in a&&b.setMetadata("ncpp",a.ncpp);a&&"xSize"in a&&"ySize"in a&&"zSize"in
a&&0<a.xSize&&0<a.ySize&&0<a.zSize&&(c.space_length=a.xSize,d.space_length=a.ySize,e.space_length=a.zSize,d.offset=c.space_length,e.offset=c.space_length*d.space_length,b._data=new Float32Array(a.xSize*a.ySize*a.zSize*b.getMetadata("ncpp")),b._data.fill(0),b._scanDataRange(),b._finishHeader());return b};$jscomp.inherits(H,ua);H.TYPE=function(){return"IMAGE3D"};H.prototype.clone=function(){var a=new H;a.setData(this._data,this.getMetadata("xspace").space_length,this.getMetadata("yspace").space_length,
this.getMetadata("zspace").space_length,{ncpp:this.getMetadata("ncpp"),order:this.getMetadata("order").slice(),deepCopy:!0});a.copyMetadataFrom(this);return a};H.prototype.setData=function(a,b,c,d,e){var f=1;e&&"ncpp"in e&&(f=e.ncpp);a.length!=b*c*d*f?console.warn("The array size does not match the width and height. Cannot init the Image3D."):(e&&"ncpp"in e&&this.setMetadata("ncpp",e.ncpp),e&&"order"in e&&this.setMetadata("order",e.order),this._data=e&&"deepCopy"in e&&e.deepCopy?new a.constructor(a):
a,a=this.getMetadata("xspace"),e=this.getMetadata("yspace"),f=this.getMetadata("zspace"),a.space_length=b,e.space_length=c,f.space_length=d,e.offset=a.space_length,f.offset=a.space_length*e.space_length,this._scanDataRange(),this._finishHeader())};H.prototype._finishHeader=function(){var a=this.getMetadata("xspace"),b=this.getMetadata("yspace"),c=this.getMetadata("zspace");a.name="xspace";b.name="yspace";c.name="zspace";a.width_space=JSON.parse(JSON.stringify(b));a.width=b.space_length;a.height_space=
JSON.parse(JSON.stringify(c));a.height=c.space_length;b.width_space=JSON.parse(JSON.stringify(a));b.width=a.space_length;b.height_space=JSON.parse(JSON.stringify(c));b.height=c.space_length;c.width_space=JSON.parse(JSON.stringify(a));c.width=a.space_length;c.height_space=JSON.parse(JSON.stringify(b));c.height=b.space_length};H.prototype._scanDataRange=function(){for(var a=Infinity,b=-Infinity,c=0;c<this._data.length;c++)a=Math.min(a,this._data[c]),b=Math.max(b,this._data[c]);this.setMetadata("voxel_min",
a);this.setMetadata("voxel_max",b)};H.prototype.setPixel=function(a,b){};H.prototype.getPixel=function(a){};H.prototype.getSize=function(a){if(this.hasMetadata(a))return this.getMetadata(a).space_length;console.warn('The space must be "xspace", "yspace" or "zspace".');return null};H.prototype.getData=function(){return this._data};H.prototype.getDataCopy=function(){return new this._data.constructor(this._data)};H.prototype.get1dIndexFrom3dPosition=function(a){};H.prototype.getSlice=function(a,b,c){b=
void 0===b?0:b;c=void 0===c?0:c;if(!this.hasMetadata(a))return console.warn("The axis "+a+" does not exist."),null;var d=this.hasMetadata("time")?c*this.getMetadata("time").offset:0,e=this.getMetadata(a),f=e.width_space,g=e.height_space;a=e.width;c=e.height;var k=e.offset,m=f.offset,l=g.offset,n=new this._data.constructor(a*c),h,f=0<f.step,p=0<g.step;h=0<e.step;var q=g=0,r=Infinity,u=-Infinity;this.getMetadata("voxel_max");b=h?b:e.space_length-b-1;if(0<=b&&b<e.space_length)for(d+=b*k,b=c-1;0<=b;b--)for(e=
p?b:c-b-1,k=d+e*l,e=0;e<a;e++)h=f?e:a-e-1,h=k+h*m,h=this._data[h],r=Math.min(r,h),u=Math.max(u,h),q+=h,n[g++]=h;m=new C;m.setData(n,a,c,1);m.setMetadata("min",r);m.setMetadata("max",u);m.setMetadata("avg",q/(g-1));return m};H.prototype.getIntensity_ijk=function(a,b,c,d){d=void 0===d?0:d;var e=this.getMetadata("order");if(0>a||a>=this.getMetadata(e[0]).space_length||0>b||b>=this.getMetadata(e[1]).space_length||0>c||c>=this.getMetadata(e[2]).space_length)return console.warn("getIntensity_ijk position is out of range."),
0;d=this.hasMetadata("time")?d*this.getMetadata("time").offset:0;a=a*this.getMetadata(e[0]).offset+b*this.getMetadata(e[1]).offset+c*this.getMetadata(e[2]).offset+d;return this._data[a]};H.prototype.getIntensity_xyz=function(a,b,c,d){d=void 0===d?0:d;this.getMetadata("order");if(0>a||a>=this.getMetadata("xspace").space_length||0>b||b>=this.getMetadata("yspace").space_length||0>c||c>=this.getMetadata("zspace").space_length)return console.warn("getIntensity_xyz position is out of range."),0;d=this.hasMetadata("time")?
d*this.getMetadata("time").offset:0;a=a*this.getMetadata("xspace").offset+b*this.getMetadata("yspace").offset+c*this.getMetadata("zspace").offset+d;return this._data[a]};var P=function(){var a;a=A.call(this)||this;a.addInputValidator(0,C);return a};$jscomp.inherits(P,A);P.prototype.hasSameSizeInput=function(){var a=this,b=!0,c=[],d=[];Object.keys(this._input).forEach(function(b){c.push(a._getInput(b).getWidth());d.push(a._getInput(b).getHeight())});c.length&&(c.sort(),d.sort(),(b=c[0]==c[c.length-
1]&&d[0]==d[d.length-1])||console.warn("Input image do not all have the same size. Filter not valid"));return b};P.prototype.hasSameNcppInput=function(){var a=Object.keys(this._input);if(!a.length)return!1;for(var b=this._getInput(a[0]).getComponentsPerPixel(),c=0;c<a.length;c++)if(b!=this._getInput(a[c]).getComponentsPerPixel())return console.warn("Input image do not all have the same number of components per pixel. Filter not valid"),!1;return!0};var Q=function(a){return H.call(this)||this};$jscomp.inherits(Q,
H);Q.transformToMinc=function(a,b){function c(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0>=a&&(a=1);return Math.sqrt(a)}function d(a,c,b){return a[0]*(c[1]*b[2]-c[2]*b[1])-a[1]*(c[0]*b[2]-c[2]*b[0])+a[2]*(c[0]*b[1]-c[1]*b[0])}for(var e=[],f=[],g=[],k=c(a[0]),m=c(a[1]),l=c(a[2]),k=0>a[0][0]?-k:k,m=0>a[1][1]?-m:m,l=0>a[2][2]?-l:l,n=0;3>n;n++)e[n]=a[n][0]/k,f[n]=a[n][1]/m,g[n]=a[n][2]/l;b.xspace.step=k;b.yspace.step=m;b.zspace.step=l;n=[a[0][3],a[1][3],a[2][3]];k=d(e,f,g);l=d(n,f,g);m=d(e,n,g);n=d(e,f,n);b.xspace.start=
l/k;b.yspace.start=m/k;b.zspace.start=n/k;b.xspace.direction_cosines=e;b.yspace.direction_cosines=f;b.zspace.direction_cosines=g};Q.swapn=function(a,b){for(var c=0;c<a.length;c+=b)for(var d=b-1,e=0;d>e;){var f=a[c+d];a[c+d]=a[c+e];a[c+e]=f;d--;e++}};Q.prototype.setData=function(a,b){var c=this;this._data=a;this.setMetadata("position",{});this.setMetadata("current_time",0);Object.keys(b).forEach(function(a){c.setMetadata(a,b[a])});this._scanDataRange();this._saveOriginAndTransform();this._finishHeader();
console.log(this._metadata)};Q.prototype._saveOriginAndTransform=function(){var a=this.getMetadata("xspace"),b=this.getMetadata("yspace"),c=this.getMetadata("zspace"),d=a.start,e=b.start,f=c.start,g=a.direction_cosines,k=b.direction_cosines,m=c.direction_cosines,a=a.step,b=b.step,c=c.step,d={x:d*g[0]+e*k[0]+f*m[0],y:d*g[1]+e*k[1]+f*m[1],z:d*g[2]+e*k[2]+f*m[2]};this.setMetadata("voxel_origin",d);this.setMetadata("w2v",[[g[0]/a,g[1]/a,g[2]/a,(-d.x*g[0]-d.y*g[1]-d.z*g[2])/a],[k[0]/b,k[1]/b,k[2]/b,(-d.x*
k[0]-d.y*k[1]-d.z*k[2])/b],[m[0]/c,m[1]/c,m[2]/c,(-d.x*m[0]-d.y*m[1]-d.z*m[2])/c]])};var Ka=function(){var a;a=A.call(this)||this;a._inputValidator[0]=C.TYPE();a.setMetadata("alpha",!1);a.setMetadata("min",0);a.setMetadata("max",255);a.setMetadata("reset",!0);a._canvas=null;a._ctx=null;return a};$jscomp.inherits(Ka,A);Ka.prototype._init=function(){var a=document.getElementById(this.getMetadata("parentDivID"));if(!a)return!1;if(this.getMetadata("reset"))for(;a.firstChild;)a.removeChild(a.firstChild);
this._canvas=document.createElement("canvas");this._canvas.style="image-rendering: pixelated;";this._ctx=this._canvas.getContext("2d");this._ctx.imageSmoothingEnabled=!0;this._ctx.mozImageSmoothingEnabled=!1;this._ctx.webkitImageSmoothingEnabled=!1;this._ctx.ctxmsImageSmoothingEnabled=!1;document.getElementById(this.getMetadata("parentDivID")).appendChild(this._canvas);return!0};Ka.prototype._run=function(){if(this.hasValidInput()){var a=this._input[0],b=a.getComponentsPerPixel();if(1!=b&&4!=b)console.warn("Cannot write Image in canvas if contains other than 1 or 4 bands.");
else if(this.getMetadata("parentDivID"))if(this._init()){var c=this.getMetadata("alpha");this._canvas.width=a.getWidth();this._canvas.height=a.getHeight();var d=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height),e=d.data,a=a.getData();if(4==b)for(b=0;b<a.length;b++)e[b]=c||3!=b%4?this._stretchMinMax(a[b]):255;else if(1==b)for(b=0;b<a.length;b++){var c=4*b,f=this._stretchMinMax(a[b]);e[c]=f;e[c+1]=f;e[c+2]=f;e[c+3]=255}else if(3==b)for(console.warn("From RGB Image2D to RGBA canvas, not sure of this implementation."),
b=c=0;b<a.length;b++)3==b%4&&(e[c]=255,c++),e[c]=this._stretchMinMax(value),c++;this._ctx.putImageData(d,0,0)}else console.warn("The parent div was not specified or does not exist.");else console.error("The parent DIV ID to place the canvas element was not specified. Unable to display anything.")}};Ka.prototype._stretchMinMax=function(a){var b=this._metadata.min,c=this._metadata.max;return 0==b&&255==c?a:(a-b)/(c-b)*255};var ab=function(a){a=A.call(this)||this;a._loadedCounter=0;a._addOutput(C,0);
return a};$jscomp.inherits(ab,A);ab.prototype._run=function(){var a=this;this.getInputCategories().forEach(function(b){a._addOutput(C,b);a._loadImage(b)})};ab.prototype._loadImage=function(a){var b=this,c=new Image;c.src=this._getInput(a);c.onload=function(){var d=document.createElement("canvas");d.width=c.width;d.height=c.height;var e=d.getContext("2d");e.drawImage(c,0,0);try{var f=e.getImageData(0,0,d.width,d.height),g=new Float32Array(f.data);b.getOutput(a).setData(g,c.width,c.height);b._loadedCounter++;
b._loadedCounter==b.getNumberOfInputs()&&"ready"in b._events&&b._events.ready(b)}catch(k){console.error(k)}}};var bb=function(){var a;a=A.call(this)||this;a._allowedTypes=/image.*/;a._addOutput(C,0);return a};$jscomp.inherits(bb,A);bb.prototype.hasValidInput=function(){var a=this._getInput();a&&a.type.match(this._allowedTypes)?this._isInputValid=!0:console.error("The file must be an image (jpg/png). The type "+a.type+" is not compatible with FileImageReader.");return!1};bb.prototype._run=function(){if(this.hasValidInput){var a=
this,b=this._getInput(),c=new FileReader;c.onload=function(b){b=new Image;b.src=c.result;var d=document.createElement("canvas");d.width=b.width;d.height=b.height;var f=d.getContext("2d");f.drawImage(b,0,0);d=f.getImageData(0,0,d.width,d.height).data;a.getOutput().setData(d,b.width,b.height);"ready"in a._events&&a._events.ready(a)};c.readAsDataURL(b)}};var La="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},ea=t,fa=y;"function"===typeof La.setTimeout&&
(ea=setTimeout);"function"===typeof La.clearTimeout&&(fa=clearTimeout);var ga=[],xa=!1,ma,Sa=-1;W.prototype.run=function(){this.fun.apply(null,this.array)};var Ca=La.performance||{},Mc=Ca.now||Ca.mozNow||Ca.msNow||Ca.oNow||Ca.webkitNow||function(){return(new Date).getTime()},Nc=new Date,rb={nextTick:function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];ga.push(new W(a,b));1!==ga.length||xa||z(aa)},title:"browser",browser:!0,env:{},
argv:[],version:"",versions:{},on:na,addListener:na,once:na,off:na,removeListener:na,removeAllListeners:na,emit:na,binding:function(a){throw Error("process.binding is not supported");},cwd:function(){return"/"},chdir:function(a){throw Error("process.chdir is not supported");},umask:function(){return 0},hrtime:function(a){var b=.001*Mc.call(Ca),c=Math.floor(b),b=Math.floor(b%1*1E9);a&&(c-=a[0],b-=a[1],0>b&&(c--,b+=1E9));return[c,b]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-
Nc)/1E3}},sb="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},qc={},rc=Object.freeze({"default":qc}),ba=[],X=[],Fc="undefined"!==typeof Uint8Array?Uint8Array:Array,eb=!1,Oc={}.toString,Hb=Array.isArray||function(a){return"[object Array]"==Oc.call(a)};p.TYPED_ARRAY_SUPPORT=void 0!==La.TYPED_ARRAY_SUPPORT?La.TYPED_ARRAY_SUPPORT:!0;var Pc=p.TYPED_ARRAY_SUPPORT?2147483647:1073741823;p.poolSize=8192;p._augment=function(a){a.__proto__=p.prototype;return a};
p.from=function(a,b,c){return Eb(null,a,b,c)};p.TYPED_ARRAY_SUPPORT&&(p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol());p.alloc=function(a,b,c){Gb(a);a=0>=a?ca(null,a):void 0!==b?"string"===typeof c?ca(null,a).fill(b,c):ca(null,a).fill(b):ca(null,a);return a};p.allocUnsafe=function(a){return fb(null,a)};p.allocUnsafeSlow=function(a){return fb(null,a)};p.isBuffer=Rb;p.compare=function(a,b){if(!Y(a)||!Y(b))throw new TypeError("Arguments must be Buffers");
if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e];d=b[e];break}return c<d?-1:d<c?1:0};p.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};p.concat=function(a,b){if(!Hb(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return p.alloc(0);
var c;if(void 0===b)for(c=b=0;c<a.length;++c)b+=a[c].length;var d=p.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){var f=a[c];if(!Y(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(d,e);e+=f.length}return d};p.byteLength=Fb;p.prototype._isBuffer=!0;p.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)oa(this,b,b+1);return this};p.prototype.swap32=function(){var a=this.length;if(0!==
a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)oa(this,b,b+3),oa(this,b+1,b+2);return this};p.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)oa(this,b,b+7),oa(this,b+1,b+6),oa(this,b+2,b+5),oa(this,b+3,b+4);return this};p.prototype.toString=function(){var a=this.length|0;return 0===a?"":0===arguments.length?Jb(this,0,a):Dc.apply(this,arguments)};p.prototype.equals=
function(a){if(!Y(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===p.compare(this,a)};p.prototype.inspect=function(){var a="";0<this.length&&(a=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(a+=" ... "));return"<Buffer "+a+">"};p.prototype.compare=function(a,b,c,d,e){if(!Y(a))throw new TypeError("Argument must be a Buffer");void 0===b&&(b=0);void 0===c&&(c=a?a.length:0);void 0===d&&(d=0);void 0===e&&(e=this.length);if(0>b||c>a.length||0>d||e>this.length)throw new RangeError("out of range index");
if(d>=e&&b>=c)return 0;if(d>=e)return-1;if(b>=c)return 1;b>>>=0;c>>>=0;d>>>=0;e>>>=0;if(this===a)return 0;var f=e-d,g=c-b,k=Math.min(f,g);d=this.slice(d,e);a=a.slice(b,c);for(b=0;b<k;++b)if(d[b]!==a[b]){f=d[b];g=a[b];break}return f<g?-1:g<f?1:0};p.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)};p.prototype.indexOf=function(a,b,c){return Kb(this,a,b,c,!0)};p.prototype.lastIndexOf=function(a,b,c){return Kb(this,a,b,c,!1)};p.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",
c=this.length,b=0;else if(void 0===c&&"string"===typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-b;if(void 0===c||c>e)c=e;if(0<a.length&&(0>c||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(e=!1;;)switch(d){case "hex":a:{b=Number(b)||0;d=this.length-b;c?(c=Number(c),c>d&&
(c=d)):c=d;d=a.length;if(0!==d%2)throw new TypeError("Invalid hex string");c>d/2&&(c=d/2);for(d=0;d<c;++d){e=parseInt(a.substr(2*d,2),16);if(isNaN(e)){a=d;break a}this[b+d]=e}a=d}return a;case "utf8":case "utf-8":return Da(Va(a,this.length-b),this,b,c);case "ascii":return Da(Qb(a),this,b,c);case "latin1":case "binary":return Da(Qb(a),this,b,c);case "base64":return Da(Ib(a),this,b,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":var f;d=a;for(var e=this.length-b,g=[],k=0;k<d.length&&!(0>
(e-=2));++k)f=d.charCodeAt(k),a=f>>8,f%=256,g.push(f),g.push(a);return Da(g,this,b,c);default:if(e)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();e=!0}};p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Mb=4096;p.prototype.slice=function(a,b){var c=this.length;a=~~a;b=void 0===b?c:~~b;0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c);0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c);b<a&&(b=a);if(p.TYPED_ARRAY_SUPPORT)c=this.subarray(a,b),c.__proto__=p.prototype;
else for(var d=b-a,c=new p(d,void 0),e=0;e<d;++e)c[e]=this[e+a];return c};p.prototype.readUIntLE=function(a,b,c){a|=0;b|=0;c||I(a,b,this.length);c=this[a];for(var d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;return c};p.prototype.readUIntBE=function(a,b,c){a|=0;b|=0;c||I(a,b,this.length);c=this[a+--b];for(var d=1;0<b&&(d*=256);)c+=this[a+--b]*d;return c};p.prototype.readUInt8=function(a,b){b||I(a,1,this.length);return this[a]};p.prototype.readUInt16LE=function(a,b){b||I(a,2,this.length);return this[a]|
this[a+1]<<8};p.prototype.readUInt16BE=function(a,b){b||I(a,2,this.length);return this[a]<<8|this[a+1]};p.prototype.readUInt32LE=function(a,b){b||I(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};p.prototype.readUInt32BE=function(a,b){b||I(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};p.prototype.readIntLE=function(a,b,c){a|=0;b|=0;c||I(a,b,this.length);c=this[a];for(var d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;c>=128*d&&(c-=Math.pow(2,
8*b));return c};p.prototype.readIntBE=function(a,b,c){a|=0;b|=0;c||I(a,b,this.length);c=b;for(var d=1,e=this[a+--c];0<c&&(d*=256);)e+=this[a+--c]*d;e>=128*d&&(e-=Math.pow(2,8*b));return e};p.prototype.readInt8=function(a,b){b||I(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};p.prototype.readInt16LE=function(a,b){b||I(a,2,this.length);var c=this[a]|this[a+1]<<8;return c&32768?c|4294901760:c};p.prototype.readInt16BE=function(a,b){b||I(a,2,this.length);var c=this[a+1]|this[a]<<8;return c&
32768?c|4294901760:c};p.prototype.readInt32LE=function(a,b){b||I(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};p.prototype.readInt32BE=function(a,b){b||I(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};p.prototype.readFloatLE=function(a,b){b||I(a,4,this.length);return Ua(this,a,!0,23,4)};p.prototype.readFloatBE=function(a,b){b||I(a,4,this.length);return Ua(this,a,!1,23,4)};p.prototype.readDoubleLE=function(a,b){b||I(a,8,this.length);return Ua(this,
a,!0,52,8)};p.prototype.readDoubleBE=function(a,b){b||I(a,8,this.length);return Ua(this,a,!1,52,8)};p.prototype.writeUIntLE=function(a,b,c,d){a=+a;b|=0;c|=0;d||T(this,a,b,c,Math.pow(2,8*c)-1,0);d=1;var e=0;for(this[b]=a&255;++e<c&&(d*=256);)this[b+e]=a/d&255;return b+c};p.prototype.writeUIntBE=function(a,b,c,d){a=+a;b|=0;c|=0;d||T(this,a,b,c,Math.pow(2,8*c)-1,0);d=c-1;var e=1;for(this[b+d]=a&255;0<=--d&&(e*=256);)this[b+d]=a/e&255;return b+c};p.prototype.writeUInt8=function(a,b,c){a=+a;b|=0;c||T(this,
a,b,1,255,0);p.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[b]=a&255;return b+1};p.prototype.writeUInt16LE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,2,65535,0);p.TYPED_ARRAY_SUPPORT?(this[b]=a&255,this[b+1]=a>>>8):Wa(this,a,b,!0);return b+2};p.prototype.writeUInt16BE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,2,65535,0);p.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a&255):Wa(this,a,b,!1);return b+2};p.prototype.writeUInt32LE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,4,4294967295,0);p.TYPED_ARRAY_SUPPORT?
(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a&255):Xa(this,a,b,!0);return b+4};p.prototype.writeUInt32BE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,4,4294967295,0);p.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a&255):Xa(this,a,b,!1);return b+4};p.prototype.writeIntLE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),T(this,a,b,c,d-1,-d));d=0;var e=1,f=0;for(this[b]=a&255;++d<c&&(e*=256);)0>a&&0===f&&0!==this[b+d-1]&&(f=1),this[b+d]=(a/e>>0)-f&255;return b+
c};p.prototype.writeIntBE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),T(this,a,b,c,d-1,-d));d=c-1;var e=1,f=0;for(this[b+d]=a&255;0<=--d&&(e*=256);)0>a&&0===f&&0!==this[b+d+1]&&(f=1),this[b+d]=(a/e>>0)-f&255;return b+c};p.prototype.writeInt8=function(a,b,c){a=+a;b|=0;c||T(this,a,b,1,127,-128);p.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[b]=a&255;return b+1};p.prototype.writeInt16LE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,2,32767,-32768);p.TYPED_ARRAY_SUPPORT?(this[b]=a&255,
this[b+1]=a>>>8):Wa(this,a,b,!0);return b+2};p.prototype.writeInt16BE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,2,32767,-32768);p.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a&255):Wa(this,a,b,!1);return b+2};p.prototype.writeInt32LE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,4,2147483647,-2147483648);p.TYPED_ARRAY_SUPPORT?(this[b]=a&255,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):Xa(this,a,b,!0);return b+4};p.prototype.writeInt32BE=function(a,b,c){a=+a;b|=0;c||T(this,a,b,4,2147483647,-2147483648);
0>a&&(a=4294967295+a+1);p.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a&255):Xa(this,a,b,!1);return b+4};p.prototype.writeFloatLE=function(a,b,c){return Ob(this,a,b,!0,c)};p.prototype.writeFloatBE=function(a,b,c){return Ob(this,a,b,!1,c)};p.prototype.writeDoubleLE=function(a,b,c){return Pb(this,a,b,!0,c)};p.prototype.writeDoubleBE=function(a,b,c){return Pb(this,a,b,!1,c)};p.prototype.copy=function(a,b,c,d){c||(c=0);d||0===d||(d=this.length);b>=a.length&&(b=a.length);
b||(b=0);0<d&&d<c&&(d=c);if(d===c||0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);a.length-b<d-c&&(d=a.length-b+c);var e=d-c;if(this===a&&c<b&&b<d)for(d=e-1;0<=d;--d)a[d+b]=this[d+c];else if(1E3>e||!p.TYPED_ARRAY_SUPPORT)for(d=0;d<e;++d)a[d+b]=this[d+c];else Uint8Array.prototype.set.call(a,this.subarray(c,
c+e),b);return e};p.prototype.fill=function(a,b,c,d){if("string"===typeof a){"string"===typeof b?(d=b,b=0,c=this.length):"string"===typeof c&&(d=c,c=this.length);if(1===a.length){var e=a.charCodeAt(0);256>e&&(a=e)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!p.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof a&&(a&=255);if(0>b||this.length<b||this.length<c)throw new RangeError("Out of range index");if(c<=
b)return this;b>>>=0;c=void 0===c?this.length:c>>>0;a||(a=0);if("number"===typeof a)for(d=b;d<c;++d)this[d]=a;else for(a=Y(a)?a:Va((new p(a,d)).toString()),e=a.length,d=0;d<c-b;++d)this[d+b]=a[d%e];return this};var Ec=/[^+\/0-9A-Za-z-_]/g,Qc=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:Pc,Buffer:p,SlowBuffer:function(a){+a!=a&&(a=0);return p.alloc(+a)},isBuffer:Rb}),sc=rc&&qc||rc,tc=Ta(function(a){(function(){function b(a){a?(n[0]=n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=
n[13]=n[14]=n[15]=0,this.blocks=n,this.buffer8=h):f?(a=new ArrayBuffer(68),this.buffer8=new Uint8Array(a),this.blocks=new Uint32Array(a)):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0;this.finalized=this.hashed=!1;this.first=!0}var c="object"===typeof window?window:{},d=!c.JS_MD5_NO_NODE_JS&&"object"===typeof rb&&rb.versions&&rb.versions.node;d&&(c=sb);var e=!c.JS_MD5_NO_COMMON_JS&&!0&&a.exports,f=!c.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,
g="0123456789abcdef".split(""),k=[128,32768,8388608,-2147483648],m=[0,8,16,24],l=["hex","array","digest","buffer","arrayBuffer"],n=[],h;if(f){var p=new ArrayBuffer(68);h=new Uint8Array(p);n=new Uint32Array(p)}var q=function(a){return function(c){return(new b(!0)).update(c)[a]()}},r=function(a){var b=Qc.Buffer;return function(c){if("string"===typeof c)return sc.createHash("md5").update(c,"utf8").digest("hex");if(c.constructor===ArrayBuffer)c=new Uint8Array(c);else if(void 0===c.length)return a(c);
return sc.createHash("md5").update(new b(c)).digest("hex")}};b.prototype.update=function(a){if(!this.finalized){var b="string"!=typeof a;b&&a.constructor==c.ArrayBuffer&&(a=new Uint8Array(a));for(var d,e=0,g,k=a.length||0,u=this.blocks,l=this.buffer8;e<k;){this.hashed&&(this.hashed=!1,u[0]=u[16],u[16]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0);if(b)if(f)for(g=this.start;e<k&&64>g;++e)l[g++]=a[e];else for(g=this.start;e<k&&64>g;++e)u[g>>2]|=a[e]<<m[g++&3];else if(f)for(g=
this.start;e<k&&64>g;++e)d=a.charCodeAt(e),128>d?l[g++]=d:(2048>d?l[g++]=192|d>>6:(55296>d||57344<=d?l[g++]=224|d>>12:(d=65536+((d&1023)<<10|a.charCodeAt(++e)&1023),l[g++]=240|d>>18,l[g++]=128|d>>12&63),l[g++]=128|d>>6&63),l[g++]=128|d&63);else for(g=this.start;e<k&&64>g;++e)d=a.charCodeAt(e),128>d?u[g>>2]|=d<<m[g++&3]:(2048>d?u[g>>2]|=(192|d>>6)<<m[g++&3]:(55296>d||57344<=d?u[g>>2]|=(224|d>>12)<<m[g++&3]:(d=65536+((d&1023)<<10|a.charCodeAt(++e)&1023),u[g>>2]|=(240|d>>18)<<m[g++&3],u[g>>2]|=(128|
d>>12&63)<<m[g++&3]),u[g>>2]|=(128|d>>6&63)<<m[g++&3]),u[g>>2]|=(128|d&63)<<m[g++&3]);this.lastByteIndex=g;this.bytes+=g-this.start;64<=g?(this.start=g-64,this.hash(),this.hashed=!0):this.start=g}return this}};b.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,b=this.lastByteIndex;a[b>>2]|=k[b&3];56<=b&&(this.hashed||this.hash(),a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0);a[14]=this.bytes<<3;this.hash()}};
b.prototype.hash=function(){var a,b,c,d,e,f=this.blocks;this.first?(a=f[0]-680876937,a=(a<<7|a>>>25)-271733879<<0,d=(-1732584194^a&2004318071)+f[1]-117830708,d=(d<<12|d>>>20)+a<<0,c=(-271733879^d&(a^-271733879))+f[2]-1126478375,c=(c<<17|c>>>15)+d<<0,b=(a^c&(d^a))+f[3]-1316259209):(a=this.h0,b=this.h1,c=this.h2,d=this.h3,a+=(d^b&(c^d))+f[0]-680876936,a=(a<<7|a>>>25)+b<<0,d+=(c^a&(b^c))+f[1]-389564586,d=(d<<12|d>>>20)+a<<0,c+=(b^d&(a^b))+f[2]+606105819,c=(c<<17|c>>>15)+d<<0,b+=(a^c&(d^a))+f[3]-1044525330);
b=(b<<22|b>>>10)+c<<0;a+=(d^b&(c^d))+f[4]-176418897;a=(a<<7|a>>>25)+b<<0;d+=(c^a&(b^c))+f[5]+1200080426;d=(d<<12|d>>>20)+a<<0;c+=(b^d&(a^b))+f[6]-1473231341;c=(c<<17|c>>>15)+d<<0;b+=(a^c&(d^a))+f[7]-45705983;b=(b<<22|b>>>10)+c<<0;a+=(d^b&(c^d))+f[8]+1770035416;a=(a<<7|a>>>25)+b<<0;d+=(c^a&(b^c))+f[9]-1958414417;d=(d<<12|d>>>20)+a<<0;c+=(b^d&(a^b))+f[10]-42063;c=(c<<17|c>>>15)+d<<0;b+=(a^c&(d^a))+f[11]-1990404162;b=(b<<22|b>>>10)+c<<0;a+=(d^b&(c^d))+f[12]+1804603682;a=(a<<7|a>>>25)+b<<0;d+=(c^a&(b^
c))+f[13]-40341101;d=(d<<12|d>>>20)+a<<0;c+=(b^d&(a^b))+f[14]-1502002290;c=(c<<17|c>>>15)+d<<0;b+=(a^c&(d^a))+f[15]+1236535329;b=(b<<22|b>>>10)+c<<0;a+=(c^d&(b^c))+f[1]-165796510;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[6]-1069501632;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[11]+643717713;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[0]-373897302;b=(b<<20|b>>>12)+c<<0;a+=(c^d&(b^c))+f[5]-701558691;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[10]+38016083;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[15]-660478335;c=(c<<14|c>>>
18)+d<<0;b+=(d^a&(c^d))+f[4]-405537848;b=(b<<20|b>>>12)+c<<0;a+=(c^d&(b^c))+f[9]+568446438;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[14]-1019803690;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[3]-187363961;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[8]+1163531501;b=(b<<20|b>>>12)+c<<0;a+=(c^d&(b^c))+f[13]-1444681467;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[2]-51403784;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[7]+1735328473;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[12]-1926607734;b=(b<<20|b>>>12)+c<<0;e=b^c;a+=(e^d)+f[5]-378558;
a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[8]-2022574463;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[11]+1839030562;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[14]-35309556;b=(b<<23|b>>>9)+c<<0;e=b^c;a+=(e^d)+f[1]-1530992060;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[4]+1272893353;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[7]-155497632;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[10]-1094730640;b=(b<<23|b>>>9)+c<<0;e=b^c;a+=(e^d)+f[13]+681279174;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[0]-358537222;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[3]-722521979;c=(c<<16|
c>>>16)+d<<0;b+=(e^c)+f[6]+76029189;b=(b<<23|b>>>9)+c<<0;e=b^c;a+=(e^d)+f[9]-640364487;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[12]-421815835;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[15]+530742520;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[2]-995338651;b=(b<<23|b>>>9)+c<<0;a+=(c^(b|~d))+f[0]-198630844;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[7]+1126891415;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[14]-1416354905;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[5]-57434055;b=(b<<21|b>>>11)+c<<0;a+=(c^(b|~d))+f[12]+1700485571;a=(a<<6|a>>>
26)+b<<0;d+=(b^(a|~c))+f[3]-1894986606;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[10]-1051523;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[1]-2054922799;b=(b<<21|b>>>11)+c<<0;a+=(c^(b|~d))+f[8]+1873313359;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[15]-30611744;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[6]-1560198380;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[13]+1309151649;b=(b<<21|b>>>11)+c<<0;a+=(c^(b|~d))+f[4]-145523070;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[11]-1120210379;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[2]+718787259;
c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[9]-343485551;b=(b<<21|b>>>11)+c<<0;this.first?(this.h0=a+1732584193<<0,this.h1=b-271733879<<0,this.h2=c-1732584194<<0,this.h3=d+271733878<<0,this.first=!1):(this.h0=this.h0+a<<0,this.h1=this.h1+b<<0,this.h2=this.h2+c<<0,this.h3=this.h3+d<<0)};b.prototype.hex=function(){this.finalize();var a=this.h0,b=this.h1,c=this.h2,d=this.h3;return g[a>>4&15]+g[a&15]+g[a>>12&15]+g[a>>8&15]+g[a>>20&15]+g[a>>16&15]+g[a>>28&15]+g[a>>24&15]+g[b>>4&15]+g[b&15]+g[b>>12&15]+g[b>>
8&15]+g[b>>20&15]+g[b>>16&15]+g[b>>28&15]+g[b>>24&15]+g[c>>4&15]+g[c&15]+g[c>>12&15]+g[c>>8&15]+g[c>>20&15]+g[c>>16&15]+g[c>>28&15]+g[c>>24&15]+g[d>>4&15]+g[d&15]+g[d>>12&15]+g[d>>8&15]+g[d>>20&15]+g[d>>16&15]+g[d>>28&15]+g[d>>24&15]};b.prototype.toString=b.prototype.hex;b.prototype.digest=function(){this.finalize();var a=this.h0,b=this.h1,c=this.h2,d=this.h3;return[a&255,a>>8&255,a>>16&255,a>>24&255,b&255,b>>8&255,b>>16&255,b>>24&255,c&255,c>>8&255,c>>16&255,c>>24&255,d&255,d>>8&255,d>>16&255,d>>
24&255]};b.prototype.array=b.prototype.digest;b.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(16),b=new Uint32Array(a);b[0]=this.h0;b[1]=this.h1;b[2]=this.h2;b[3]=this.h3;return a};b.prototype.buffer=b.prototype.arrayBuffer;p=function(){var a=q("hex");d&&(a=r(a));a.create=function(){return new b};a.update=function(b){return a.create().update(b)};for(var c=0;c<l.length;++c){var e=l[c];a[e]=q(e)}return a}();e?a.exports=p:c.md5=p})()}),B=Ta(function(a,b){var c="undefined"!==
typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}}return a};b.shrinkBuf=function(a,b){if(a.length===b)return a;if(a.subarray)return a.subarray(0,b);a.length=b;return a};var d={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)a.set(b.subarray(c,
c+d),e);else for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f;b=d=0;for(c=a.length;b<c;b++)d+=a[b].length;f=new Uint8Array(d);b=d=0;for(c=a.length;b<c;b++)e=a[b],f.set(e,d),d+=e.length;return f}},e={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(a){a?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,d)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,e))};
b.setTyped(c)}),lb=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ya=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Sc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],uc=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ia=Array(576);ya(ia);var Ma=Array(60);ya(Ma);var pa=Array(512);ya(pa);var Fa=Array(256);ya(Fa);var mb=Array(29);ya(mb);var Za=Array(30);ya(Za);var vc,wc,xc,yc=!1,Z={_tr_init:function(a){if(!yc){var b,c,d,e=Array(16);for(d=c=0;28>d;d++)for(mb[d]=c,b=0;b<1<<
lb[d];b++)Fa[c++]=d;Fa[c-1]=d;for(d=c=0;16>d;d++)for(Za[d]=c,b=0;b<1<<Ya[d];b++)pa[c++]=d;for(c>>=7;30>d;d++)for(Za[d]=c<<7,b=0;b<1<<Ya[d]-7;b++)pa[256+c++]=d;for(b=0;15>=b;b++)e[b]=0;for(b=0;143>=b;)ia[2*b+1]=8,b++,e[8]++;for(;255>=b;)ia[2*b+1]=9,b++,e[9]++;for(;279>=b;)ia[2*b+1]=7,b++,e[7]++;for(;287>=b;)ia[2*b+1]=8,b++,e[8]++;Ub(ia,287,e);for(b=0;30>b;b++)Ma[2*b+1]=5,Ma[2*b]=Tb(b,5);vc=new ib(ia,lb,257,286,15);wc=new ib(Ma,Ya,0,30,15);xc=new ib([],Sc,0,19,7);yc=!0}a.l_desc=new jb(a.dyn_ltree,vc);
a.d_desc=new jb(a.dyn_dtree,wc);a.bl_desc=new jb(a.bl_tree,xc);a.bi_buf=0;a.bi_valid=0;Vb(a)},_tr_stored_block:ac,_tr_flush_block:function(a,b,c,d){var e,f,g=0;if(0<a.level){2===a.strm.data_type&&(a.strm.data_type=Gc(a));nb(a,a.l_desc);nb(a,a.d_desc);Zb(a,a.dyn_ltree,a.l_desc.max_code);Zb(a,a.dyn_dtree,a.d_desc.max_code);nb(a,a.bl_desc);for(g=18;3<=g&&0===a.bl_tree[2*uc[g]+1];g--);a.opt_len+=3*(g+1)+14;e=a.opt_len+3+7>>>3;f=a.static_len+3+7>>>3;f<=e&&(e=f)}else e=f=c+5;if(c+4<=e&&-1!==b)ac(a,b,c,
d);else if(4===a.strategy||f===e)U(a,2+(d?1:0),3),Yb(a,ia,Ma);else{U(a,4+(d?1:0),3);b=a.l_desc.max_code+1;c=a.d_desc.max_code+1;g+=1;U(a,b-257,5);U(a,c-1,5);U(a,g-4,4);for(e=0;e<g;e++)U(a,a.bl_tree[2*uc[e]+1],3);$b(a,a.dyn_ltree,b-1);$b(a,a.dyn_dtree,c-1);Yb(a,a.dyn_ltree,a.dyn_dtree)}Vb(a);d&&Wb(a)},_tr_tally:function(a,b,c){a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255;a.pending_buf[a.d_buf+2*a.last_lit+1]=b&255;a.pending_buf[a.l_buf+a.last_lit]=c&255;a.last_lit++;0===b?a.dyn_ltree[2*c]++:(a.matches++,
b--,a.dyn_ltree[2*(Fa[c]+256+1)]++,a.dyn_dtree[2*(256>b?pa[b]:pa[256+(b>>>7)])]++);return a.last_lit===a.lit_bufsize-1},_tr_align:function(a){U(a,2,3);N(a,256,ia);16===a.bi_valid?(Ea(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):8<=a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf&255,a.bi_buf>>=8,a.bi_valid-=8)}},Ha=function(a,b,c,d){var e=a&65535|0;a=a>>>16&65535|0;for(var f;0!==c;){f=2E3<c?2E3:c;c-=f;do e=e+b[d++]|0,a=a+e|0;while(--f);e%=65521;a%=65521}return e|a<<16|0},Tc=function(){for(var a,b=[],c=0;256>
c;c++){a=c;for(var d=0;8>d;d++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}(),K=function(a,b,c,d){c=d+c;for(a^=-1;d<c;d++)a=a>>>8^Tc[(a^b[d])&255];return a^-1},za={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ba;Ba=[new da(0,0,0,0,function(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(1>=a.lookahead){qa(a);if(0===a.lookahead&&0===b)return 1;
if(0===a.lookahead)break}a.strstart+=a.lookahead;a.lookahead=0;var d=a.block_start+c;if(0===a.strstart||a.strstart>=d)if(a.lookahead=a.strstart-d,a.strstart=d,J(a,!1),0===a.strm.avail_out)return 1;if(a.strstart-a.block_start>=a.w_size-262&&(J(a,!1),0===a.strm.avail_out))return 1}a.insert=0;if(4===b)return J(a,!0),0===a.strm.avail_out?3:4;a.strstart>a.block_start&&J(a,!1);return 1}),new da(4,4,8,4,ob),new da(4,5,16,8,ob),new da(4,6,32,32,ob),new da(4,4,16,16,Aa),new da(8,16,32,32,Aa),new da(8,16,128,
128,Aa),new da(8,32,128,256,Aa),new da(32,128,258,1024,Aa),new da(32,258,258,4096,Aa)];var Ia={deflateInit:function(a,b){return ec(a,b,8,15,8,0)},deflateInit2:ec,deflateReset:dc,deflateResetKeep:cc,deflateSetHeader:function(a,b){if(!a||!a.state||2!==a.state.wrap)return-2;a.state.gzhead=b;return 0},deflate:function(a,b){var c,d,e,f;if(!a||!a.state||5<b||0>b)return a?ha(a,-2):-2;d=a.state;if(!a.output||!a.input&&0!==a.avail_in||666===d.status&&4!==b)return ha(a,0===a.avail_out?-5:-2);d.strm=a;c=d.last_flush;
d.last_flush=b;42===d.status&&(2===d.wrap?(a.adler=0,x(d,31),x(d,139),x(d,8),d.gzhead?(x(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),x(d,d.gzhead.time&255),x(d,d.gzhead.time>>8&255),x(d,d.gzhead.time>>16&255),x(d,d.gzhead.time>>24&255),x(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),x(d,d.gzhead.os&255),d.gzhead.extra&&d.gzhead.extra.length&&(x(d,d.gzhead.extra.length&255),x(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(a.adler=K(a.adler,
d.pending_buf,d.pending,0)),d.gzindex=0,d.status=69):(x(d,0),x(d,0),x(d,0),x(d,0),x(d,0),x(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),x(d,3),d.status=113)):(e=8+(d.w_bits-8<<4)<<8,e|=(2<=d.strategy||2>d.level?0:6>d.level?1:6===d.level?2:3)<<6,0!==d.strstart&&(e|=32),d.status=113,Ga(d,e+(31-e%31)),0!==d.strstart&&(Ga(d,a.adler>>>16),Ga(d,a.adler&65535)),a.adler=1));if(69===d.status)if(d.gzhead.extra){for(e=d.pending;d.gzindex<(d.gzhead.extra.length&65535)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&
d.pending>e&&(a.adler=K(a.adler,d.pending_buf,d.pending-e,e)),ka(a),e=d.pending,d.pending!==d.pending_buf_size));)x(d,d.gzhead.extra[d.gzindex]&255),d.gzindex++;d.gzhead.hcrc&&d.pending>e&&(a.adler=K(a.adler,d.pending_buf,d.pending-e,e));d.gzindex===d.gzhead.extra.length&&(d.gzindex=0,d.status=73)}else d.status=73;if(73===d.status)if(d.gzhead.name){e=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>e&&(a.adler=K(a.adler,d.pending_buf,d.pending-e,e)),ka(a),e=d.pending,d.pending===
d.pending_buf_size)){f=1;break}f=d.gzindex<d.gzhead.name.length?d.gzhead.name.charCodeAt(d.gzindex++)&255:0;x(d,f)}while(0!==f);d.gzhead.hcrc&&d.pending>e&&(a.adler=K(a.adler,d.pending_buf,d.pending-e,e));0===f&&(d.gzindex=0,d.status=91)}else d.status=91;if(91===d.status)if(d.gzhead.comment){e=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>e&&(a.adler=K(a.adler,d.pending_buf,d.pending-e,e)),ka(a),e=d.pending,d.pending===d.pending_buf_size)){f=1;break}f=d.gzindex<d.gzhead.comment.length?
d.gzhead.comment.charCodeAt(d.gzindex++)&255:0;x(d,f)}while(0!==f);d.gzhead.hcrc&&d.pending>e&&(a.adler=K(a.adler,d.pending_buf,d.pending-e,e));0===f&&(d.status=103)}else d.status=103;103===d.status&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&ka(a),d.pending+2<=d.pending_buf_size&&(x(d,a.adler&255),x(d,a.adler>>8&255),a.adler=0,d.status=113)):d.status=113);if(0!==d.pending){if(ka(a),0===a.avail_out)return d.last_flush=-1,0}else if(0===a.avail_in&&(b<<1)-(4<b?9:0)<=(c<<1)-(4<c?9:0)&&4!==b)return ha(a,
-5);if(666===d.status&&0!==a.avail_in)return ha(a,-5);if(0!==a.avail_in||0!==d.lookahead||0!==b&&666!==d.status){c=2===d.strategy?Ic(d,b):3===d.strategy?Hc(d,b):Ba[d.level].func(d,b);if(3===c||4===c)d.status=666;if(1===c||3===c)return 0===a.avail_out&&(d.last_flush=-1),0;if(2===c&&(1===b?Z._tr_align(d):5!==b&&(Z._tr_stored_block(d,0,0,!1),3===b&&(ja(d.head),0===d.lookahead&&(d.strstart=0,d.block_start=0,d.insert=0))),ka(a),0===a.avail_out))return d.last_flush=-1,0}if(4!==b)return 0;if(0>=d.wrap)return 1;
2===d.wrap?(x(d,a.adler&255),x(d,a.adler>>8&255),x(d,a.adler>>16&255),x(d,a.adler>>24&255),x(d,a.total_in&255),x(d,a.total_in>>8&255),x(d,a.total_in>>16&255),x(d,a.total_in>>24&255)):(Ga(d,a.adler>>>16),Ga(d,a.adler&65535));ka(a);0<d.wrap&&(d.wrap=-d.wrap);return 0!==d.pending?0:1},deflateEnd:function(a){var b;if(!a||!a.state)return-2;b=a.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return ha(a,-2);a.state=null;return 113===b?ha(a,-3):0},deflateSetDictionary:function(a,
b){var c=b.length,d,e,f,g,k,m;if(!a||!a.state)return-2;d=a.state;f=d.wrap;if(2===f||1===f&&42!==d.status||d.lookahead)return-2;1===f&&(a.adler=Ha(a.adler,b,c,0));d.wrap=0;c>=d.w_size&&(0===f&&(ja(d.head),d.strstart=0,d.block_start=0,d.insert=0),g=new B.Buf8(d.w_size),B.arraySet(g,b,c-d.w_size,d.w_size,0),b=g,c=d.w_size);g=a.avail_in;k=a.next_in;m=a.input;a.avail_in=c;a.next_in=0;a.input=b;for(qa(d);3<=d.lookahead;){c=d.strstart;e=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[c+3-1])&d.hash_mask,
d.prev[c&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=c,c++;while(--e);d.strstart=c;d.lookahead=2;qa(d)}d.strstart+=d.lookahead;d.block_start=d.strstart;d.insert=d.lookahead;d.lookahead=0;d.match_length=d.prev_length=2;d.match_available=0;a.next_in=k;a.input=m;a.avail_in=g;d.wrap=f;return 0},deflateInfo:"pako deflate (from Nodeca project)"},hc=!0,gc=!0;try{String.fromCharCode.apply(null,[0])}catch(a){hc=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){gc=!1}for(var Na=new B.Buf8(256),
la=0;256>la;la++)Na[la]=252<=la?6:248<=la?5:240<=la?4:224<=la?3:192<=la?2:1;Na[254]=Na[254]=1;var sa={string2buf:function(a){var b,c,d,e,f,g=a.length,k=0;for(e=0;e<g;e++)c=a.charCodeAt(e),55296===(c&64512)&&e+1<g&&(d=a.charCodeAt(e+1),56320===(d&64512)&&(c=65536+(c-55296<<10)+(d-56320),e++)),k+=128>c?1:2048>c?2:65536>c?3:4;b=new B.Buf8(k);for(e=f=0;f<k;e++)c=a.charCodeAt(e),55296===(c&64512)&&e+1<g&&(d=a.charCodeAt(e+1),56320===(d&64512)&&(c=65536+(c-55296<<10)+(d-56320),e++)),128>c?b[f++]=c:(2048>
c?b[f++]=192|c>>>6:(65536>c?b[f++]=224|c>>>12:(b[f++]=240|c>>>18,b[f++]=128|c>>>12&63),b[f++]=128|c>>>6&63),b[f++]=128|c&63);return b},buf2binstring:function(a){return fc(a,a.length)},binstring2buf:function(a){for(var b=new B.Buf8(a.length),c=0,d=b.length;c<d;c++)b[c]=a.charCodeAt(c);return b},buf2string:function(a,b){var c,d,e,f,g=b||a.length,k=Array(2*g);for(c=d=0;c<g;)if(e=a[c++],128>e)k[d++]=e;else if(f=Na[e],4<f)k[d++]=65533,c+=f-1;else{for(e&=2===f?31:3===f?15:7;1<f&&c<g;)e=e<<6|a[c++]&63,f--;
1<f?k[d++]=65533:65536>e?k[d++]=e:(e-=65536,k[d++]=55296|e>>10&1023,k[d++]=56320|e&1023)}return fc(k,d)},utf8border:function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);for(c=b-1;0<=c&&128===(a[c]&192);)c--;return 0>c||0===c?b:c+Na[a[c]]>b?c:b}},ic=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0},jc=Object.prototype.toString;ra.prototype.push=function(a,
b){var c=this.strm,d=this.options.chunkSize,e,f;if(this.ended)return!1;f=b===~~b?b:!0===b?4:0;"string"===typeof a?c.input=sa.string2buf(a):"[object ArrayBuffer]"===jc.call(a)?c.input=new Uint8Array(a):c.input=a;c.next_in=0;c.avail_in=c.input.length;do{0===c.avail_out&&(c.output=new B.Buf8(d),c.next_out=0,c.avail_out=d);e=Ia.deflate(c,f);if(1!==e&&0!==e)return this.onEnd(e),this.ended=!0,!1;if(0===c.avail_out||0===c.avail_in&&(4===f||2===f))if("string"===this.options.to)this.onData(sa.buf2binstring(B.shrinkBuf(c.output,
c.next_out)));else this.onData(B.shrinkBuf(c.output,c.next_out))}while((0<c.avail_in||0===c.avail_out)&&1!==e);if(4===f)return e=Ia.deflateEnd(this.strm),this.onEnd(e),this.ended=!0,0===e;2===f&&(this.onEnd(0),c.avail_out=0);return!0};ra.prototype.onData=function(a){this.chunks.push(a)};ra.prototype.onEnd=function(a){0===a&&(this.result="string"===this.options.to?this.chunks.join(""):B.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};var Uc={Deflate:ra,deflate:pb,deflateRaw:function(a,
b){b=b||{};b.raw=!0;return pb(a,b)},gzip:function(a,b){b=b||{};b.gzip=!0;return pb(a,b)}},Vc=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Wc=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Xc=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Yc=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,
64],Oa=function(a,b,c,d,e,f,g,k){var m=k.bits,l,n,h,p,q,r,u,t,w,A,V,y,C,z=0,x,D=new B.Buf16(16);q=new B.Buf16(16);var H,G=0,I,F,K;for(l=0;15>=l;l++)D[l]=0;for(n=0;n<d;n++)D[b[c+n]]++;p=m;for(h=15;1<=h&&0===D[h];h--);p>h&&(p=h);if(0===h)return e[f++]=20971520,e[f++]=20971520,k.bits=1,0;for(m=1;m<h&&0===D[m];m++);p<m&&(p=m);for(l=r=1;15>=l;l++)if(r<<=1,r-=D[l],0>r)return-1;if(0<r&&(0===a||1!==h))return-1;q[1]=0;for(l=1;15>l;l++)q[l+1]=q[l]+D[l];for(n=0;n<d;n++)0!==b[c+n]&&(g[q[b[c+n]]++]=n);0===a?(C=
H=g,x=19):1===a?(C=Vc,z-=257,H=Wc,G-=257,x=256):(C=Xc,H=Yc,x=-1);n=t=0;l=m;y=f;d=p;q=0;A=-1;u=1<<p;V=u-1;if(1===a&&852<u||2===a&&592<u)return 1;for(;;){I=l-q;g[n]<x?(F=0,K=g[n]):g[n]>x?(F=H[G+g[n]],K=C[z+g[n]]):(F=96,K=0);r=1<<l-q;m=w=1<<d;do w-=r,e[y+(t>>q)+w]=I<<24|F<<16|K|0;while(0!==w);for(r=1<<l-1;t&r;)r>>=1;0!==r?(t&=r-1,t+=r):t=0;n++;if(0===--D[l]){if(l===h)break;l=b[c+g[n]]}if(l>p&&(t&V)!==A){0===q&&(q=p);y+=m;d=l-q;for(r=1<<d;d+q<h;){r-=D[d+q];if(0>=r)break;d++;r<<=1}u+=1<<d;if(1===a&&852<
u||2===a&&592<u)return 1;A=t&V;e[A]=p<<24|d<<16|y-f|0}}0!==t&&(e[y+t]=l-q<<24|4194304);k.bits=p;return 0},zc=!0,tb,ub,Ja={inflateReset:mc,inflateReset2:nc,inflateResetKeep:lc,inflateInit:function(a){return oc(a,15)},inflateInit2:oc,inflate:function(a,b){var c,d,e,f,g,k,m,l,n,h,p,q,r,u,t,w,A,V,y=new B.Buf8(4),C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;c=a.state;12===c.mode&&(c.mode=13);g=a.next_out;e=a.output;m=a.avail_out;f=a.next_in;
d=a.input;k=a.avail_in;l=c.hold;n=c.bits;h=k;p=m;V=0;a:for(;;)switch(c.mode){case 1:if(0===c.wrap){c.mode=13;break}for(;16>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}if(c.wrap&2&&35615===l){c.check=0;y[0]=l&255;y[1]=l>>>8&255;c.check=K(c.check,y,2,0);n=l=0;c.mode=2;break}c.flags=0;c.head&&(c.head.done=!1);if(!(c.wrap&1)||(((l&255)<<8)+(l>>8))%31){a.msg="incorrect header check";c.mode=30;break}if(8!==(l&15)){a.msg="unknown compression method";c.mode=30;break}l>>>=4;n-=4;r=(l&15)+8;if(0===c.wbits)c.wbits=
r;else if(r>c.wbits){a.msg="invalid window size";c.mode=30;break}c.dmax=1<<r;a.adler=c.check=1;c.mode=l&512?10:12;n=l=0;break;case 2:for(;16>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.flags=l;if(8!==(c.flags&255)){a.msg="unknown compression method";c.mode=30;break}if(c.flags&57344){a.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=l>>8&1);c.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,c.check=K(c.check,y,2,0));n=l=0;c.mode=3;case 3:for(;32>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.head&&
(c.head.time=l);c.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,y[2]=l>>>16&255,y[3]=l>>>24&255,c.check=K(c.check,y,4,0));n=l=0;c.mode=4;case 4:for(;16>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.head&&(c.head.xflags=l&255,c.head.os=l>>8);c.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,c.check=K(c.check,y,2,0));n=l=0;c.mode=5;case 5:if(c.flags&1024){for(;16>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.length=l;c.head&&(c.head.extra_len=l);c.flags&512&&(y[0]=l&255,y[1]=l>>>8&255,c.check=K(c.check,y,2,0));n=l=0}else c.head&&
(c.head.extra=null);c.mode=6;case 6:if(c.flags&1024&&(q=c.length,q>k&&(q=k),q&&(c.head&&(r=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),B.arraySet(c.head.extra,d,f,q,r)),c.flags&512&&(c.check=K(c.check,d,q,f)),k-=q,f+=q,c.length-=q),c.length))break a;c.length=0;c.mode=7;case 7:if(c.flags&2048){if(0===k)break a;q=0;do r=d[f+q++],c.head&&r&&65536>c.length&&(c.head.name+=String.fromCharCode(r));while(r&&q<k);c.flags&512&&(c.check=K(c.check,d,q,f));k-=q;f+=q;if(r)break a}else c.head&&
(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.flags&4096){if(0===k)break a;q=0;do r=d[f+q++],c.head&&r&&65536>c.length&&(c.head.comment+=String.fromCharCode(r));while(r&&q<k);c.flags&512&&(c.check=K(c.check,d,q,f));k-=q;f+=q;if(r)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(c.flags&512){for(;16>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}if(l!==(c.check&65535)){a.msg="header crc mismatch";c.mode=30;break}n=l=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);a.adler=c.check=
0;c.mode=12;break;case 10:for(;32>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}a.adler=c.check=kc(l);n=l=0;c.mode=11;case 11:if(0===c.havedict)return a.next_out=g,a.avail_out=m,a.next_in=f,a.avail_in=k,c.hold=l,c.bits=n,2;a.adler=c.check=1;c.mode=12;case 12:if(5===b||6===b)break a;case 13:if(c.last){l>>>=n&7;n-=n&7;c.mode=27;break}for(;3>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.last=l&1;l>>>=1;--n;switch(l&3){case 0:c.mode=14;break;case 1:r=c;if(zc){tb=new B.Buf32(512);ub=new B.Buf32(32);for(q=
0;144>q;)r.lens[q++]=8;for(;256>q;)r.lens[q++]=9;for(;280>q;)r.lens[q++]=7;for(;288>q;)r.lens[q++]=8;Oa(1,r.lens,0,288,tb,0,r.work,{bits:9});for(q=0;32>q;)r.lens[q++]=5;Oa(2,r.lens,0,32,ub,0,r.work,{bits:5});zc=!1}r.lencode=tb;r.lenbits=9;r.distcode=ub;r.distbits=5;c.mode=20;if(6===b){l>>>=2;n-=2;break a}break;case 2:c.mode=17;break;case 3:a.msg="invalid block type",c.mode=30}l>>>=2;n-=2;break;case 14:l>>>=n&7;for(n-=n&7;32>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}if((l&65535)!==(l>>>16^65535)){a.msg=
"invalid stored block lengths";c.mode=30;break}c.length=l&65535;n=l=0;c.mode=15;if(6===b)break a;case 15:c.mode=16;case 16:if(q=c.length){q>k&&(q=k);q>m&&(q=m);if(0===q)break a;B.arraySet(e,d,f,q,g);k-=q;f+=q;m-=q;g+=q;c.length-=q;break}c.mode=12;break;case 17:for(;14>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.nlen=(l&31)+257;l>>>=5;n-=5;c.ndist=(l&31)+1;l>>>=5;n-=5;c.ncode=(l&15)+4;l>>>=4;n-=4;if(286<c.nlen||30<c.ndist){a.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=
18;case 18:for(;c.have<c.ncode;){for(;3>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.lens[C[c.have++]]=l&7;l>>>=3;n-=3}for(;19>c.have;)c.lens[C[c.have++]]=0;c.lencode=c.lendyn;c.lenbits=7;q={bits:c.lenbits};V=Oa(0,c.lens,0,19,c.lencode,0,c.work,q);c.lenbits=q.bits;if(V){a.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;;){t=c.lencode[l&(1<<c.lenbits)-1];q=t>>>24;t&=65535;if(q<=n)break;if(0===k)break a;k--;l+=d[f++]<<n;n+=8}if(16>t)l>>>=q,
n-=q,c.lens[c.have++]=t;else{if(16===t){for(r=q+2;n<r;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}l>>>=q;n-=q;if(0===c.have){a.msg="invalid bit length repeat";c.mode=30;break}r=c.lens[c.have-1];q=3+(l&3);l>>>=2;n-=2}else if(17===t){for(r=q+3;n<r;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}l>>>=q;n-=q;r=0;q=3+(l&7);l>>>=3;n-=3}else{for(r=q+7;n<r;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}l>>>=q;n-=q;r=0;q=11+(l&127);l>>>=7;n-=7}if(c.have+q>c.nlen+c.ndist){a.msg="invalid bit length repeat";c.mode=30;break}for(;q--;)c.lens[c.have++]=
r}}if(30===c.mode)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block";c.mode=30;break}c.lenbits=9;q={bits:c.lenbits};V=Oa(1,c.lens,0,c.nlen,c.lencode,0,c.work,q);c.lenbits=q.bits;if(V){a.msg="invalid literal/lengths set";c.mode=30;break}c.distbits=6;c.distcode=c.distdyn;q={bits:c.distbits};V=Oa(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,q);c.distbits=q.bits;if(V){a.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===b)break a;case 20:c.mode=21;case 21:if(6<=k&&258<=m){a.next_out=
g;a.avail_out=m;a.next_in=f;a.avail_in=k;c.hold=l;c.bits=n;var z,x,D,H,G,I,F,J,E,L,O=a;L=O.state;E=O.next_in;e=O.input;J=E+(O.avail_in-5);F=O.next_out;d=O.output;I=F-(p-O.avail_out);G=F+(O.avail_out-257);H=L.dmax;t=L.wsize;A=L.whave;w=L.wnext;u=L.window;r=L.hold;q=L.bits;n=L.lencode;l=L.distcode;m=(1<<L.lenbits)-1;k=(1<<L.distbits)-1;b:do c:for(15>q&&(r+=e[E++]<<q,q+=8,r+=e[E++]<<q,q+=8),z=n[r&m];;){g=z>>>24;r>>>=g;q-=g;g=z>>>16&255;if(0===g)d[F++]=z&65535;else if(g&16){f=z&65535;if(g&=15)q<g&&(r+=
e[E++]<<q,q+=8),f+=r&(1<<g)-1,r>>>=g,q-=g;15>q&&(r+=e[E++]<<q,q+=8,r+=e[E++]<<q,q+=8);z=l[r&k];d:for(;;){g=z>>>24;r>>>=g;q-=g;g=z>>>16&255;if(g&16){D=z&65535;g&=15;q<g&&(r+=e[E++]<<q,q+=8,q<g&&(r+=e[E++]<<q,q+=8));D+=r&(1<<g)-1;if(D>H){O.msg="invalid distance too far back";L.mode=30;break b}r>>>=g;q-=g;g=F-I;if(D>g){g=D-g;if(g>A&&L.sane){O.msg="invalid distance too far back";L.mode=30;break b}x=0;z=u;if(0===w){if(x+=t-g,g<f){f-=g;do d[F++]=u[x++];while(--g);x=F-D;z=d}}else if(w<g){if(x+=t+w-g,g-=
w,g<f){f-=g;do d[F++]=u[x++];while(--g);x=0;if(w<f){g=w;f-=g;do d[F++]=u[x++];while(--g);x=F-D;z=d}}}else if(x+=w-g,g<f){f-=g;do d[F++]=u[x++];while(--g);x=F-D;z=d}for(;2<f;)d[F++]=z[x++],d[F++]=z[x++],d[F++]=z[x++],f-=3;f&&(d[F++]=z[x++],1<f&&(d[F++]=z[x++]))}else{x=F-D;do d[F++]=d[x++],d[F++]=d[x++],d[F++]=d[x++],f-=3;while(2<f);f&&(d[F++]=d[x++],1<f&&(d[F++]=d[x++]))}}else if(0===(g&64)){z=l[(z&65535)+(r&(1<<g)-1)];continue d}else{O.msg="invalid distance code";L.mode=30;break b}break}}else if(0===
(g&64)){z=n[(z&65535)+(r&(1<<g)-1)];continue c}else{g&32?L.mode=12:(O.msg="invalid literal/length code",L.mode=30);break b}break}while(E<J&&F<G);f=q>>3;E-=f;q-=f<<3;O.next_in=E;O.next_out=F;O.avail_in=E<J?5+(J-E):5-(E-J);O.avail_out=F<G?257+(G-F):257-(F-G);L.hold=r&(1<<q)-1;L.bits=q;g=a.next_out;e=a.output;m=a.avail_out;f=a.next_in;d=a.input;k=a.avail_in;l=c.hold;n=c.bits;12===c.mode&&(c.back=-1);break}for(c.back=0;;){t=c.lencode[l&(1<<c.lenbits)-1];q=t>>>24;r=t>>>16&255;t&=65535;if(q<=n)break;if(0===
k)break a;k--;l+=d[f++]<<n;n+=8}if(r&&0===(r&240)){u=q;w=r;for(A=t;;){t=c.lencode[A+((l&(1<<u+w)-1)>>u)];q=t>>>24;r=t>>>16&255;t&=65535;if(u+q<=n)break;if(0===k)break a;k--;l+=d[f++]<<n;n+=8}l>>>=u;n-=u;c.back+=u}l>>>=q;n-=q;c.back+=q;c.length=t;if(0===r){c.mode=26;break}if(r&32){c.back=-1;c.mode=12;break}if(r&64){a.msg="invalid literal/length code";c.mode=30;break}c.extra=r&15;c.mode=22;case 22:if(c.extra){for(r=c.extra;n<r;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.length+=l&(1<<c.extra)-1;l>>>=
c.extra;n-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=23;case 23:for(;;){t=c.distcode[l&(1<<c.distbits)-1];q=t>>>24;r=t>>>16&255;t&=65535;if(q<=n)break;if(0===k)break a;k--;l+=d[f++]<<n;n+=8}if(0===(r&240)){u=q;w=r;for(A=t;;){t=c.distcode[A+((l&(1<<u+w)-1)>>u)];q=t>>>24;r=t>>>16&255;t&=65535;if(u+q<=n)break;if(0===k)break a;k--;l+=d[f++]<<n;n+=8}l>>>=u;n-=u;c.back+=u}l>>>=q;n-=q;c.back+=q;if(r&64){a.msg="invalid distance code";c.mode=30;break}c.offset=t;c.extra=r&15;c.mode=24;case 24:if(c.extra){for(r=
c.extra;n<r;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}c.offset+=l&(1<<c.extra)-1;l>>>=c.extra;n-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===m)break a;q=p-m;if(c.offset>q){q=c.offset-q;if(q>c.whave&&c.sane){a.msg="invalid distance too far back";c.mode=30;break}q>c.wnext?(q-=c.wnext,r=c.wsize-q):r=c.wnext-q;q>c.length&&(q=c.length);u=c.window}else u=e,r=g-c.offset,q=c.length;q>m&&(q=m);m-=q;c.length-=q;do e[g++]=u[r++];while(--q);
0===c.length&&(c.mode=21);break;case 26:if(0===m)break a;e[g++]=c.length;m--;c.mode=21;break;case 27:if(c.wrap){for(;32>n;){if(0===k)break a;k--;l|=d[f++]<<n;n+=8}p-=m;a.total_out+=p;c.total+=p;p&&(a.adler=c.check=c.flags?K(c.check,e,p,g-p):Ha(c.check,e,p,g-p));p=m;if((c.flags?l:kc(l))!==c.check){a.msg="incorrect data check";c.mode=30;break}n=l=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;32>n;){if(0===k)break a;k--;l+=d[f++]<<n;n+=8}if(l!==(c.total&4294967295)){a.msg="incorrect length check";c.mode=
30;break}n=l=0}c.mode=29;case 29:V=1;break a;case 30:V=-3;break a;case 31:return-4;default:return-2}a.next_out=g;a.avail_out=m;a.next_in=f;a.avail_in=k;c.hold=l;c.bits=n;if((c.wsize||p!==a.avail_out&&30>c.mode&&(27>c.mode||4!==b))&&pc(a,a.output,a.next_out,p-a.avail_out))return c.mode=31,-4;h-=a.avail_in;p-=a.avail_out;a.total_in+=h;a.total_out+=p;c.total+=p;c.wrap&&p&&(a.adler=c.check=c.flags?K(c.check,e,p,a.next_out-p):Ha(c.check,e,p,a.next_out-p));a.data_type=c.bits+(c.last?64:0)+(12===c.mode?
128:0)+(20===c.mode||15===c.mode?256:0);(0===h&&0===p||4===b)&&0===V&&(V=-5);return V},inflateEnd:function(a){if(!a||!a.state)return-2;var b=a.state;b.window&&(b.window=null);a.state=null;return 0},inflateGetHeader:function(a,b){var c;if(!a||!a.state)return-2;c=a.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0},inflateSetDictionary:function(a,b){var c=b.length,d,e;if(!a||!a.state)return-2;d=a.state;if(0!==d.wrap&&11!==d.mode)return-2;if(11===d.mode&&(e=Ha(1,b,c,0),e!==d.check))return-3;
if(pc(a,b,c,c))return d.mode=31,-4;d.havedict=1;return 0},inflateInfo:"pako inflate (from Nodeca project)"},G={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Lc=function(){this.os=
this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1},Ac=Object.prototype.toString;ta.prototype.push=function(a,b){var c=this.strm,d=this.options.chunkSize,e=this.options.dictionary,f,g,k,m,l,h=!1;if(this.ended)return!1;g=b===~~b?b:!0===b?G.Z_FINISH:G.Z_NO_FLUSH;"string"===typeof a?c.input=sa.binstring2buf(a):"[object ArrayBuffer]"===Ac.call(a)?c.input=new Uint8Array(a):c.input=a;c.next_in=0;c.avail_in=c.input.length;do{0===c.avail_out&&
(c.output=new B.Buf8(d),c.next_out=0,c.avail_out=d);f=Ja.inflate(c,G.Z_NO_FLUSH);f===G.Z_NEED_DICT&&e&&(f="string"===typeof e?sa.string2buf(e):"[object ArrayBuffer]"===Ac.call(e)?new Uint8Array(e):e,f=Ja.inflateSetDictionary(this.strm,f));f===G.Z_BUF_ERROR&&!0===h&&(f=G.Z_OK,h=!1);if(f!==G.Z_STREAM_END&&f!==G.Z_OK)return this.onEnd(f),this.ended=!0,!1;if(c.next_out&&(0===c.avail_out||f===G.Z_STREAM_END||0===c.avail_in&&(g===G.Z_FINISH||g===G.Z_SYNC_FLUSH)))if("string"===this.options.to)k=sa.utf8border(c.output,
c.next_out),m=c.next_out-k,l=sa.buf2string(c.output,k),c.next_out=m,c.avail_out=d-m,m&&B.arraySet(c.output,c.output,k,m,0),this.onData(l);else this.onData(B.shrinkBuf(c.output,c.next_out));0===c.avail_in&&0===c.avail_out&&(h=!0)}while((0<c.avail_in||0===c.avail_out)&&f!==G.Z_STREAM_END);f===G.Z_STREAM_END&&(g=G.Z_FINISH);if(g===G.Z_FINISH)return f=Ja.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===G.Z_OK;g===G.Z_SYNC_FLUSH&&(this.onEnd(G.Z_OK),c.avail_out=0);return!0};ta.prototype.onData=function(a){this.chunks.push(a)};
ta.prototype.onEnd=function(a){a===G.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):B.flattenChunks(this.chunks));this.chunks=[];this.err=a;this.msg=this.strm.msg};var Zc=B.assign,va={};Zc(va,Uc,{Inflate:ta,inflate:qb,inflateRaw:function(a,b){b=b||{};b.raw=!0;return qb(a,b)},ungzip:qb},G);var Pa=function(){var a;a=A.call(this)||this;a._outputCounter=0;a.setMetadata("filenames",{});a.setMetadata("checksums",{});return a};$jscomp.inherits(Pa,A);Pa.prototype._run=function(){var a=
this;this._outputCounter=0;this.getInputCategories().forEach(function(b){a._loadFile(b)})};Pa.prototype._loadFile=function(a){var b=this,c=new FileReader;c.onloadend=function(c){c=c.target.result;var d=b._getInput(a).name.split(/[\\/]/).pop(),f=d.split(".").pop(),g=tc(c);b._metadata.filenames[a]=d;b._metadata.checksums[a]=g;if(f.localeCompare("pixp"))try{c=va.inflate(c).buffer,console.log("File was un-gziped successfully")}catch(k){console.log("Pako: "+k+" (this content is not gziped)")}b._output[a]=
c;b._fileLoadCount()};c.onerror=function(){this._output[a]=null;b._fileLoadCount();console.warn("error reading file from category "+a)};c.readAsArrayBuffer(this._getInput(a))};Pa.prototype._fileLoadCount=function(){this._outputCounter++;this._outputCounter==this.getNumberOfInputs()&&this._events.ready(this)};var cb=function(){var a;a=A.call(this)||this;a._outputCounter=0;a.setMetadata("filenames",{});a.setMetadata("checksums",{});return a};$jscomp.inherits(cb,A);cb.prototype._run=function(){var a=
this;this.getNumberOfInputs()?this._forEachInput(function(b,c){a._loadUrl(b,c)}):console.warn("No input was specified, cannot run this filer.")};cb.prototype._loadUrl=function(a,b){var c=this,d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="arraybuffer";d.onload=function(e){e=d.response;var f=b.split(/[\\/]/).pop(),g=f.split(".").pop(),k=tc(e);c._metadata.filenames[a]=f;c._metadata.checksums[a]=k;if(g.localeCompare("pixp"))try{e=va.inflate(e).buffer,console.log("File was un-gziped successfully")}catch(m){console.log("Pako: "+
m+" (this content is not gziped)")}c._output[a]=e;c._outputCounter++;c._outputCounter==c.getNumberOfInputs()&&"ready"in c._events&&c._events.ready(c)};d.error=function(){console.log("here go the error")};d.send()};var w=function(){var a;a=A.call(this)||this;a.setMetadata("debug",!1);a._type_enum={INT8:1,UINT8:2,INT16:3,UINT16:4,INT32:5,UINT32:6,FLT:7,DBL:8,STR:9};a._type_matching="int8 uint8 int16 uint16 int32 uint32 float32 float64 undef".split(" ");a.type_sizes=[0,1,1,2,2,4,4,4,8,0];a._dv_offset=
0;a._align=8;a._little_endian=!0;a._continuation_queue=[];a._dv=null;a._superblk={};a._start_offset=0;a._huge_id=0;return a};$jscomp.inherits(w,A);w.prototype.createLink=function(){return{hdr_offset:0,data_offset:0,data_length:0,n_filled:0,chunk_size:0,sym_btree:0,sym_lheap:0,name:"",attributes:{},children:[],array:void 0,type:-1,inflate:!1,dims:[]}};w.prototype.startAlignment=function(){this._start_offset=this._dv_offset};w.prototype.checkAlignment=function(){var a=this._dv_offset-this._start_offset;
if(0!==a%this._align){var b=this._align-a%this._align;this._dv_offset+=b;this.getMetadata("debug")&&console.log("skipping "+b+" bytes at "+a+" for alignmnent")}};w.prototype.skip=function(a){this._dv_offset+=a};w.prototype.seek=function(a){this._dv_offset=a};w.prototype.tell=function(){return this._dv_offset};w.prototype.getU8=function(){var a=this._dv.getUint8(this._dv_offset);this._dv_offset+=1;return a};w.prototype.getU16=function(){var a=this._dv.getUint16(this._dv_offset,this._little_endian);
this._dv_offset+=2;return a};w.prototype.getU32=function(){var a=this._dv.getUint32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a};w.prototype.getU64=function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=8;return a};w.prototype.getF32=function(){var a=this._dv.getFloat32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a};w.prototype.getF64=function(){var a=this._dv.getFloat64(this._dv_offset,this._little_endian);this._dv_offset+=
8;return a};w.prototype.getOffset=function(a){var b;a=a||this._superblk.offsz;if(4===a)b=this._dv.getUint32(this._dv_offset,this._little_endian);else if(8===a)b=this._dv.getUint64(this._dv_offset,this._little_endian);else throw Error("Unsupported value for offset size "+a);this._dv_offset+=a;return b};w.prototype.getLength=function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=this._superblk.lensz;return a};w.prototype.getString=function(a){var b="",c,d;for(c=0;c<
a;c+=1){d=this.getU8();if(0===d){this._dv_offset+=a-c-1;break}b+=String.fromCharCode(d)}return b};w.prototype.getArray=function(a,b,c){var d=this._getInput(),e=this._dv_offset;c&&(this._dv_offset=c);switch(a){case this._type_enum.INT8:a=new Int8Array(d,this._dv_offset,b);break;case this._type_enum.UINT8:a=new Uint8Array(d,this._dv_offset,b);break;case this._type_enum.INT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(b),b/=2,a=new Int16Array(a),d=0;d<b;d+=1)a[d]=this.getU16();else a=new Int16Array(d,
this._dv_offset,b/2),this._dv_offset+=b;break;case this._type_enum.UINT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(b),b/=2,a=new Uint16Array(a),d=0;d<b;d+=1)a[d]=this.getU16();else a=new Uint16Array(d,this._dv_offset,b/2),this._dv_offset+=b;break;case this._type_enum.INT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Int32Array(a),d=0;d<b;d+=1)a[d]=this.getU32();else a=new Int32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.UINT32:if(0!==this._dv_offset%
4)for(a=new ArrayBuffer(b),b/=4,a=new Uint32Array(a),d=0;d<b;d+=1)a[d]=this.getU32();else a=new Uint32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.FLT:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Float32Array(a),d=0;d<b;d+=1)a[d]=this.getF32();else a=new Float32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.DBL:if(0!==this._dv_offset%8)for(a=new ArrayBuffer(b),b/=8,a=new Float64Array(a),d=0;d<b;d+=1)a[d]=this.getF64();else a=
new Float64Array(d,this._dv_offset,b/8),this._dv_offset+=b;break;default:throw Error("Bad type in this.getArray "+a);}c&&(this._dv_offset=e);return a};w.prototype.getUXX=function(a){var b,c;switch(a){case 1:b=this._dv.getUint8(this._dv_offset);break;case 2:b=this._dv.getUint16(this._dv_offset,this._little_endian);break;case 4:b=this._dv.getUint32(this._dv_offset,this._little_endian);break;case 8:b=this._dv.getUint64(this._dv_offset,this._little_endian);break;default:if(b=0,this._little_endian)for(c=
a-1;0<=c;c--)b=(b<<8)+this._dv.getUint8(this._dv_offset+c);else for(c=0;c<a;c++)b=(b<<8)+this._dv.getUint8(this._dv_offset+c)}this._dv_offset+=a;return b};w.prototype.checkSignature=function(a){var b;for(b=0;b<a.length;b+=1)if(this._dv.getUint8(this._dv_offset+b)!==a.charCodeAt(b))return!1;this.skip(a.length);return!0};w.prototype.hdf5Superblock=function(){var a={};if(!this.checkSignature("\u0089HDF\r\n\u001a\n"))throw Error("Bad magic string in HDF5");a.sbver=this.getU8();if(2<a.sbver)throw Error("Unsupported HDF5 superblock version "+
a.sbver);1>=a.sbver?(a.fsver=this.getU8(),a.rgver=this.getU8(),this.skip(1),a.shver=this.getU8(),a.offsz=this.getU8(),a.lensz=this.getU8(),this.skip(1),a.gln_k=this.getU16(),a.gin_k=this.getU16(),a.cflags=this.getU32(),1===a.sbver&&(a.isin_k=this.getU16(),this.skip(2)),a.base_addr=this.getOffset(a.offsz),a.gfsi_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.dib_addr=this.getOffset(a.offsz),a.root_ln_offs=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.root_cache_type=
this.getU32(),this.skip(4),this.skip(16)):(a.offsz=this.getU8(),a.lensz=this.getU8(),a.cflags=this.getU8(),a.base_addr=this.getOffset(a.offsz),a.ext_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.checksum=this.getU32());this.getMetadata("debug")&&console.log("HDF5 SB "+a.sbver+" "+a.offsz+" "+a.lensz+" "+a.cflags);return a};w.prototype.hdf5FractalHeapHeader=function(){var a={};if(!this.checkSignature("FRHP"))throw Error("Bad or missing FRHP signature");
a.ver=this.getU8();a.idlen=this.getU16();a.iof_el=this.getU16();a.flags=this.getU8();a.objmax=this.getU32();a.objnid=this.getLength();a.objbta=this.getOffset();a.nf_blk=this.getLength();a.af_blk=this.getOffset();a.heap_total=this.getLength();a.heap_alloc=this.getLength();a.bai_offset=this.getLength();a.heap_nobj=this.getLength();a.heap_chuge=this.getLength();a.heap_nhuge=this.getLength();a.heap_ctiny=this.getLength();a.heap_ntiny=this.getLength();a.table_width=this.getU16();a.start_blksz=this.getLength();
a.max_blksz=this.getLength();a.max_heapsz=this.getU16();a.rib_srows=this.getU16();a.root_addr=this.getOffset();a.rib_crows=this.getU16();var b=Math.log2(a.max_blksz)-Math.log2(a.start_blksz)+2;a.K=Math.min(a.rib_crows,b)*a.table_width;a.N=a.rib_crows<b?0:a.K-b*a.table_width;this.getMetadata("debug")&&(console.log("FRHP V"+a.ver+" F"+a.flags+" "+a.objbta+" Total:"+a.heap_total+" Alloc:"+a.heap_alloc+" #obj:"+a.heap_nobj+" width:"+a.table_width+" start_blksz:"+a.start_blksz+" max_blksz:"+a.max_blksz+
" "+a.max_heapsz+" srows:"+a.rib_srows+" crows:"+a.rib_crows+" "+a.heap_nhuge),console.log("   K: "+a.K+" N: "+a.N));if(0<a.iof_el)throw Error("Filters present in fractal heap.");return a};w.prototype.hdf5V2BtreeHeader=function(){var a={};if(!this.checkSignature("BTHD"))throw Error("Bad or missing BTHD signature");a.ver=this.getU8();a.type=this.getU8();a.nodesz=this.getU32();a.recsz=this.getU16();a.depth=this.getU16();a.splitp=this.getU8();a.mergep=this.getU8();a.root_addr=this.getOffset();a.root_nrec=
this.getU16();a.total_nrec=this.getLength();a.checksum=this.getU32();this.getMetadata("debug")&&console.log("BTHD V"+a.ver+" T"+a.type+" "+a.nodesz+" "+a.recsz+" "+a.depth+" "+a.root_addr+" "+a.root_nrec+" "+a.total_nrec);return a};w.prototype.hdf5V2BtreeRecords=function(a,b,c,d){var e,f,g;if(1===b)for(b=0;b<c;b++)f=this.getOffset(),g=this.getLength(),a=this.getLength(),this.getMetadata("debug")&&console.log("  -> "+f+" "+g+" "+a+" "+this._this._huge_id),e=this.tell(),a===this._this._huge_id&&(this.seek(f),
this.hdf5MsgAttribute(g,d)),this.seek(e);else if(8===b){var k,m;k=a.max_heapsz/8;b=Math.min(a.objmax,a.max_blksz);m=256>=b?1:65536>=b?2:4;for(b=0;b<c;b++){e=this.getU8();if(0!==(e&192))throw Error("Bad Fractal Heap ID version "+e);var l=e&48,h;if(16===l)this._this._huge_id=this.getUXX(7);else if(0===l)f=this.getUXX(k),g=this.getUXX(m);else throw Error("Can't handle this Heap ID: "+e);h=this.getU8();this.getU32();this.getU32();this.getMetadata("debug")&&console.log("  -> "+e+" "+f+" "+g+" "+h);e=this.tell();
if(16===l)if(this.seek(a.objbta),l=this.hdf5V2BtreeHeader(),1===l.type)this.seek(l.root_addr),this.hdf5V2BtreeLeafNode(a,l.root_nrec,d);else throw Error("Can only handle type-1 btrees");else l=this.hdf5FractalHeapOffset(a,f),this.seek(l),this.hdf5MsgAttribute(g,d);this.seek(e)}}else throw Error("Unhandled V2 btree type.");};w.prototype.hdf5V2BtreeLeafNode=function(a,b,c){if(!this.checkSignature("BTLF"))throw Error("Bad or missing BTLF signature");var d=this.getU8(),e=this.getU8();this.getMetadata("debug")&&
console.log("BTLF V"+d+" T"+e+" "+this.tell());this.hdf5V2BtreeRecords(a,e,b,c)};w.prototype.hdf5V2BtreeInternalNode=function(a,b,c,d){if(!this.checkSignature("BTIN"))throw Error("Bad or missing BTIN signature");var e=this.getU8(),f=this.getU8();this.getMetadata("debug")&&console.log("BTIN V"+e+" T"+f);this.hdf5V2BtreeRecords(a,f,b,d);for(a=0;a<=b;a++){d=this.getOffset();var e=this.getUXX(1),g;1<c&&(g=this.getUXX(1));this.getMetadata("debug")&&console.log(" child->"+d+" "+e+" "+g)}};w.prototype.hdf5GetMsgName=
function(a){var b="NIL;Dataspace;LinkInfo;Datatype;FillValue 1;FillValue 2;Link;ExternalFiles;Layout;BOGUS;GroupInfo;FilterPipeline;Attribute;ObjectComment;ObjectModTime 1;SharedMsgTable;ObjHdrContinue;SymbolTable;ObjectModTime 2;BtreeKValue;DriverInfo;AttrInfo;ObjectRefCnt;MESSAGE23;FileSpaceInfo".split(";");if(a<b.length)return b[a];throw Error("Unknown message type "+a+" "+this.tell());};w.prototype.hdf5V1BtreeNode=function(a){var b=this._getInput(),c,d={};if(!this.checkSignature("TREE"))throw Error("Bad TREE signature at "+
this.tell());d.keys=[];d.node_type=this.getU8();d.node_level=this.getU8();d.entries_used=this.getU16();d.left_sibling=this.getOffset();d.right_sibling=this.getOffset();this.getMetadata("debug")&&console.log("BTREE type "+d.node_type+" lvl "+d.node_level+" n_used "+d.entries_used+" "+d.left_sibling+" "+d.right_sibling);if(a){var e,f=[];for(c=0;c<d.entries_used;c+=1){d.keys[c]={};f[c]={};f[c].chunk_size=this.getU32();f[c].filter_mask=this.getU32();f[c].chunk_offsets=[];for(e=0;e<a.dims.length+1;e+=
1)f[c].chunk_offsets.push(this.getU64());d.keys[c].child_address=this.getOffset();c<d.entries_used&&this.getMetadata("debug")&&console.log("  BTREE "+c+" chunk_size "+f[c].chunk_size+" filter_mask "+f[c].filter_mask+" addr "+d.keys[c].child_address)}f[c]={};f[c].chunk_size=this.getU32();f[c].filter_mask=this.getU32();f[c].chunk_offsets=[];for(e=0;e<a.dims.length+1;e+=1)f[c].chunk_offsets.push(this.getU64());if(0===d.node_level){var g;for(c=0;c<d.entries_used;c+=1)if(e=f[c].chunk_size,g=d.keys[c].child_address,
a.inflate){e=new Uint8Array(b,g,e);g=va.inflate(e);switch(a.type){case this._type_enum.INT8:g=new Int8Array(g.buffer);break;case this._type_enum.UINT8:g=new Uint8Array(g.buffer);break;case this._type_enum.INT16:g=new Int16Array(g.buffer);break;case this._type_enum.UINT16:g=new Uint16Array(g.buffer);break;case this._type_enum.INT32:g=new Int32Array(g.buffer);break;case this._type_enum.UINT32:g=new Uint32Array(g.buffer);break;case this._type_enum.FLT:g=new Float32Array(g.buffer);break;case this._type_enum.DBL:g=
new Float64Array(g.buffer);break;default:throw Error("Unknown type code "+a.type);}a.array.length-a.n_filled<g.length&&(g=g.subarray(0,a.array.length-a.n_filled));a.array.set(g,a.n_filled);a.n_filled+=g.length;this.getMetadata("debug")&&console.log(a.name+" "+e.length+" "+g.length+" "+a.n_filled+"/"+a.array.length)}else g=this.getArray(a.type,e,g),a.array.set(g,a.n_filled),a.n_filled+=g.length}else for(c=0;c<d.entries_used;c+=1)this.seek(d.keys[c].child_address),this.hdf5V1BtreeNode(a)}else for(c=
0;c<d.entries_used;c+=1)d.keys[c]={},d.keys[c].key_value=this.getLength(),d.keys[c].child_address=this.getOffset(),this.getMetadata("debug")&&console.log("  BTREE "+c+" key "+d.keys[c].key_value+" adr "+d.keys[c].child_address);return d};w.prototype.hdf5GroupSymbolTable=function(a,b){if(!this.checkSignature("SNOD"))throw Error("Bad or missing SNOD signature");var c=this.getU8();this.skip(1);var d=this.getU16();this.getMetadata("debug")&&console.log("this.hdf5GroupSymbolTable V"+c+" #"+d+" '"+b.name+
"'");for(var e,f,g,k,m,c=0;c<2*this._superblk.gln_k;c+=1)e=this.getOffset(),f=this.getOffset(),g=this.getU32(),this.skip(20),c<d&&(k=this.createLink(),k.hdr_offset=f,a&&(m=this.tell(),this.seek(a.lh_dseg_off+e),k.name=this.getString(a.lh_dseg_len),this.seek(m)),this.getMetadata("debug")&&console.log("    "+c+" O "+e+" A "+f+" T "+g+" '"+k.name+"'"),b.children.push(k))};w.prototype.hdf5LocalHeap=function(){var a={};if(!this.checkSignature("HEAP"))throw Error("Bad or missing HEAP signature");a.lh_ver=
this.getU8();this.skip(3);a.lh_dseg_len=this.getLength();a.lh_flst_len=this.getLength();a.lh_dseg_off=this.getOffset();this.getMetadata("debug")&&console.log("LHEAP V"+a.lh_ver+" "+a.lh_dseg_len+" "+a.lh_flst_len+" "+a.lh_dseg_off);return a};w.prototype.hdf5MsgDataspace=function(a,b){var c,d=this.getU8(),e=this.getU8(),f=this.getU8();1>=d?this.skip(5):this.skip(1);var g=1,k=[],m;for(m=0;m<e;m+=1)k[m]=this.getLength(),g*=k[m];c=e*this._superblk.lensz+(1>=d?8:4);if(0!==(f&1))for(c+=e*this._superblk.lensz,
m=0;m<e;m+=1)this.getLength();if(0!==(f&2))for(c+=e*this._superblk.lensz,m=0;m<e;m+=1)this.getLength();d="this.hdf5MsgDataspace V"+d+" N"+e+" F"+f;this.getMetadata("debug")&&(0!==e&&(d+="["+k.join(", ")+"]"),console.log(d));c<a&&this.skip(a-c);b&&(b.dims=k);return g};w.prototype.hdf5MsgLinkInfo=function(a){var b=this,c=this.getU8(),d=this.getU8();0!==(d&1)&&this.getU64();var e=this.getOffset(),f=this.getOffset();0!==(d&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgLinkInfo V"+
c+" F"+d+" FH "+e+" BT "+f);c=this.tell();if(e<this._superblk.eof_addr){this.seek(e);var g=this.hdf5FractalHeapHeader(),k=0;this.hdf5FractalHeapEnumerate(g,function(c,d,e,f){for(c=d+f;k<g.heap_nobj&&b.tell()<c;)b.hdf5MsgLink(a),k+=1;return!0})}this.seek(c)};w.prototype.dt_class_name=function(a){var b="Fixed-Point Floating-Point Time String BitField Opaque Compound Reference Enumerated Variable-Length Array".split(" ");if(a<b.length)return b[a];throw Error("Unknown datatype class: "+a);};w.prototype.hdf5MsgDatatype=
function(a){var b={},c=8,d,e,f,g,k,h,l,n,p=this.getU8();d=p>>4;e=p&15;g=[];for(p=0;3>p;p+=1)g[p]=this.getU8();p=this.getU32();this.getMetadata("debug")&&console.log("this.hdf5MsgDatatype V"+d+" C"+e+" "+this.dt_class_name(e)+" "+g[0]+"."+g[1]+"."+g[2]+" "+p);switch(e){case 0:e=this.getU16();f=this.getU16();switch(p){case 4:b.typ_type=g[0]&8?this._type_enum.INT32:this._type_enum.UINT32;break;case 2:b.typ_type=g[0]&8?this._type_enum.INT16:this._type_enum.UINT16;break;case 1:b.typ_type=g[0]&8?this._type_enum.INT8:
this._type_enum.UINT8;break;default:throw Error("Unknown type size "+p);}b.typ_length=p;c+=4;this.getMetadata("debug")&&console.log("  ("+e+" "+f+")");break;case 1:d="";if(this.getMetadata("debug"))switch(g[0]&65){case 0:d+="LE ";break;case 1:d+="BE ";break;case 65:d+="VX ";break;default:throw Error("Reserved fp byte order: "+g[0]);}e=this.getU16();f=this.getU16();g=this.getU8();k=this.getU8();h=this.getU8();l=this.getU8();n=this.getU32();this.getMetadata("debug")&&(d+=e+" "+f+" "+g+" "+k+" "+h+" "+
l+" "+n);if(64===f&&0===e&&52===g&&11===k&&0===h&&52===l&&1023===n&&8===p)b.typ_type=this._type_enum.DBL;else if(32===f&&0===e&&23===g&&8===k&&0===h&&23===l&&127===n&&4===p)b.typ_type=this._type_enum.FLT;else throw Error("Unsupported floating-point type");this.getMetadata("debug")&&console.log(d);b.typ_length=p;c+=12;break;case 3:b.typ_type=this._type_enum.STR;b.typ_length=p;break;default:throw Error("Unimplemented HDF5 data class "+e);}a>c&&this.skip(a-c);return b};w.prototype.hdf5MsgLayout=function(a){var b=
"",c=this.getU8(),d,e,f,g=[];f=1;if(1===c||2===c){e=this.getU8();d=this.getU8();this.skip(5);this.getMetadata("debug")&&(b+="this.hdf5MsgLayout V"+c+" N"+e+" C"+d);if(1===d||2===d)c=this.getOffset(),this.getMetadata("debug")&&(b+=" A"+c),a.data_offset=c;for(c=0;c<e;c+=1)g[c]=this.getU32(),f*=g[c];this.getMetadata("debug")&&(b+="["+g.join(", ")+"]");2===d&&(e=this.getU32(),a.chunk_size=f*e,this.getMetadata("debug")&&(b+=" E"+e));0===d?(f=this.getU32(),this.getMetadata("debug")&&(b+="("+f+")"),a.data_offset=
this.tell(),a.data_length=f):1===d&&(a.data_length=f)}else if(3===c)if(d=this.getU8(),b="this.hdf5MsgLayout V"+c+" C"+d,0===d)f=this.getU16(),this.getMetadata("debug")&&(b+="("+f+")"),a.data_offset=this.tell(),a.data_length=f;else if(1===d)d=this.getOffset(),f=this.getLength(),this.getMetadata("debug")&&(b+="("+d+", "+f+")"),a.data_offset=d,a.data_length=f;else{if(2===d){e=this.getU8();d=this.getOffset();a.data_offset=d;a.chunk_size=1;for(c=0;c<e-1;c+=1)g[c]=this.getU32(),f*=g[c];this.getMetadata("debug")&&
(b+="(N"+e+", A"+d+" ["+g.join(",")+"]");e=this.getU32();a.chunk_size=f*e;this.getMetadata("debug")&&(b+=" E"+e)}}else throw Error("Illegal layout version "+c);this.getMetadata("debug")&&console.log(b)};w.prototype.hdf5MsgPipeline=function(a){var b=this.getU8(),c=this.getU8(),d="this.hdf5MsgPipeline V"+b+" N"+c;1===b&&this.skip(6);this.getMetadata("debug")&&console.log(d);for(var e,f,g,k,d=0;d<c;d+=1){e=this.getU16();if(1!==e)throw Error("Unimplemented HDF5 filter "+e);if("object"!==typeof va)throw Error("Need pako to inflate data.");
a.inflate=!0;f=1===b||256<e?this.getU16():0;g=this.getU16();k=this.getU16();0!==(k&1)&&(k+=1);0!==f&&this.skip(f);this.skip(4*k);this.getMetadata("debug")&&console.log("  "+d+" ID"+e+" F"+g+" "+k)}};w.prototype.hdf5MsgAttribute=function(a,b){var c=this.getU8(),d=this.getU8(),e=this.getU16(),f=this.getU16(),g=this.getU16(),k="this.hdf5MsgAttribute V"+c+" F"+d+" "+a+": ";if(0!==(d&3))throw Error("Shared dataspaces and datatypes are not supported.");3===c&&(d=this.getU8(),this.getMetadata("debug")&&
(k+=0===d?"ASCII":"UTF-8"));this.getMetadata("debug")&&(k+="("+e+" "+f+" "+g+")");3>c&&(e=8*Math.floor((e+7)/8),f=8*Math.floor((f+7)/8),g=8*Math.floor((g+7)/8),this.getMetadata("debug")&&(k+="/("+e+" "+f+" "+g+")"));d=this.getString(e);this.getMetadata("debug")&&console.log(k+(" Name: "+d));var k=this.hdf5MsgDatatype(f),h=this.hdf5MsgDataspace(g),c=0<a?3>c?a-(8+e+f+g):a-(9+e+f+g):k.typ_length*h;this.getMetadata("debug")&&console.log("  attribute data size "+c+" "+this.tell());c=k.typ_type===this._type_enum.STR?
this.getString(c):this.getArray(k.typ_type,c);b.attributes[d]=c};w.prototype.hdf5MsgGroupInfo=function(){var a=4,b=8,c=this.getU8(),d=this.getU8();0!==(d&1)&&(this.getU16(),this.getU16());0!==(d&2)&&(a=this.getU16(),b=this.getU16());this.getMetadata("debug")&&console.log("this.hdf5MsgGroupInfo V"+c+" F"+d+" ENT "+a+" LNL "+b)};w.prototype.hdf5MsgLink=function(a){var b=this.getU8(),c=0;if(1!==b)throw Error("Bad link message version "+b);var d=this.getU8();0!==(d&8)&&(c=this.getU8());0!==(d&4)&&this.getU64();
0!==(d&16)&&this.getU8();var e=this.getUXX(1<<(d&3)),f=this.createLink();f.name=this.getString(e);0===(d&8)&&(f.hdr_offset=this.getOffset());this.getMetadata("debug")&&console.log("this.hdf5MsgLink V"+b+" F"+d+" T"+c+" NM "+f.name+" OF "+f.hdr_offset);a.children.push(f)};w.prototype.hdf5FractalHeapDirectBlock=function(a,b,c,d){if(!this.checkSignature("FHDB"))throw Error("Bad or missing FHDB signature");var e=this.getU8();if(0!==e)throw Error("Bad FHDB version: "+e);this.getOffset();var f=this.getUXX(Math.ceil(a.max_heapsz/
8));0!==(a.flags&2)&&this.getU32();this.getMetadata("debug")&&console.log("FHDB V:"+e+" R:"+b+" O:"+f+" A:"+c);a=1>=b?a.start_blksz:Math.pow(2,b-1)*a.start_blksz;return d?d(b,c,f,a):!0};w.prototype.hdf5FractalHeapIndirectBlock=function(a,b){if(!this.checkSignature("FHIB"))throw Error("Bad or missing FHIB signature");var c=this.getU8();if(0!==c)throw Error("Bad FHIB version: "+c);this.getOffset();var d=this.getUXX(Math.ceil(a.max_heapsz/8));this.getMetadata("debug")&&console.log("FHIB V:"+c+" O:"+
d);for(var e=[],c=0;c<a.K;c+=1)d=this.getOffset(),d<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("direct block at "+d),e.push(d));for(var f=[],c=0;c<a.N;c+=1)d=this.getOffset(),d<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("indirect block at "+d),f.push(d));this.getU32();for(c=0;c<e.length;c++)if(this.seek(e[c]),!this.hdf5FractalHeapDirectBlock(a,c/a.table_width,e[c],b))return!1;for(c=0;c<f.length;c++)if(this.seek(f[c]),!this.hdf5FractalHeapIndirectBlock(a,
b))return!1;return!0};w.prototype.hdf5FractalHeapEnumerate=function(a,b){this.seek(a.root_addr);0===a.K?this.hdf5FractalHeapDirectBlock(a,0,a.root_addr,b):this.hdf5FractalHeapIndirectBlock(a,b)};w.prototype.hdf5FractalHeapOffset=function(a,b){var c;this.hdf5FractalHeapEnumerate(a,function(a,e,f,g){return b>=f&&b<f+g?(c=e+(b-f),!1):!0});return c};w.prototype.hdf5MsgAttrInfo=function(a){var b=this.getU8();if(0!==b)throw Error("Bad attribute information message version: "+b);var c=this.getU8();0!==(c&
1)&&this.getU16();var d=this.getOffset(),e=this.getOffset();0!==(c&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgAttrInfo V"+b+" F"+c+" HP "+d+" AN "+e);var b=this.tell(),f;d<this._superblk.eof_addr&&(this.seek(d),f=this.hdf5FractalHeapHeader());if(e<this._superblk.eof_addr){this.seek(e);d=this.hdf5V2BtreeHeader();if(8!==d.type)throw Error("Can only handle indexed attributes.");this.seek(d.root_addr);0<d.depth?this.hdf5V2BtreeInternalNode(f,d.root_nrec,d.depth,a):this.hdf5V2BtreeLeafNode(f,
d.root_nrec,a)}this.seek(b)};w.prototype.hdf5ProcessMessage=function(a,b){var c={};switch(a.hm_type){case 1:this.hdf5MsgDataspace(a.hm_size,b);break;case 2:this.hdf5MsgLinkInfo(b);break;case 3:c=this.hdf5MsgDatatype(a.hm_size);b&&(b.type=c.typ_type);break;case 6:this.hdf5MsgLink(b);break;case 8:this.hdf5MsgLayout(b);break;case 10:this.hdf5MsgGroupInfo();break;case 11:this.hdf5MsgPipeline(b);break;case 12:this.hdf5MsgAttribute(a.hm_size,b);break;case 16:c.cq_off=this.getOffset();c.cq_len=this.getLength();
this._continuation_queue.push(c);this.getMetadata("debug")&&console.log("hdf5MsgObjHdrContinue "+c.cq_off+" "+c.cq_len);break;case 17:b.sym_btree=this.getOffset();b.sym_lheap=this.getOffset();this.getMetadata("debug")&&console.log("hdf5MsgSymbolTable "+b.sym_btree+" "+b.sym_lheap);break;case 21:this.hdf5MsgAttrInfo(b);break;case 0:case 4:case 5:case 7:case 18:case 19:case 20:case 22:case 24:this.skip(a.hm_size);break;default:throw Error("Unknown message type: "+a.hm_type);}};w.prototype.hdf5V2ObjectHeader=
function(a){if(!this.checkSignature("OHDR"))throw Error("Bad or missing OHDR signature");var b=this.getU8(),c=this.getU8();0!==(c&32)&&(this.getU32(),this.getU32(),this.getU32(),this.getU32());0!==(c&16)&&(this.getU16(),this.getU16());var d=this.getUXX(1<<(c&3)),e=0,f=0,g=d;for(this.getMetadata("debug")&&console.log("this.hdf5V2ObjectHeader V"+b+" F"+c+" HS"+d);;){for(;8<=g-f;)b={},b.hm_type=this.getU8(),b.hm_size=this.getU16(),b.hm_flags=this.getU8(),this.getMetadata("debug")&&console.log("  msg"+
e+" F"+b.hm_flags+" T "+b.hm_type+" S "+b.hm_size+" ("+f+"/"+g+") "+this.hdf5GetMsgName(b.hm_type)),0!==(c&4)&&(b.hm_corder=this.getU16()),d=this.tell(),this.hdf5ProcessMessage(b,a),this.seek(d+b.hm_size),f+=b.hm_size+4,e+=1;4<g-f&&this.skip(g-(f+4));this.getU32();if(0!==this._continuation_queue.length){if(b=this._continuation_queue.shift(),this.seek(b.cq_off),g=b.cq_len-4,f=0,this.getMetadata("debug")&&console.log("continuing with "+b.cq_len+" bytes at "+this.tell()),!this.checkSignature("OCHK"))throw Error("Bad v2 object continuation");
}else break}a.children.forEach(function(a,c){that.seek(a.hdr_offset);that.getMetadata("debug")&&console.log(c+" "+a.hdr_offset+" "+a.name);this.checkSignature("OHDR")?(that.seek(a.hdr_offset),that.hdf5V2ObjectHeader(a)):(that.seek(a.hdr_offset),that.hdf5V1ObjectHeader(a))})};w.prototype.loadData=function(a){var b=this;if(0!==a.chunk_size){this.seek(a.data_offset);var c=1,d;for(d=0;d<a.dims.length;d+=1)c*=a.dims[d];c*=this.typeSize(a.type);this.getMetadata("debug")&&console.log("allocating "+c+" bytes");
c=new ArrayBuffer(c);a.n_filled=0;switch(a.type){case this._type_enum.INT8:a.array=new Int8Array(c);break;case this._type_enum.UINT8:a.array=new Uint8Array(c);break;case this._type_enum.INT16:a.array=new Int16Array(c);break;case this._type_enum.UINT16:a.array=new Uint16Array(c);break;case this._type_enum.INT32:a.array=new Int32Array(c);break;case this._type_enum.UINT32:a.array=new Uint32Array(c);break;case this._type_enum.FLT:a.array=new Float32Array(c);break;case this._type_enum.DBL:a.array=new Float64Array(c);
break;default:throw Error("Illegal type: "+a.type);}this.hdf5V1BtreeNode(a)}else 0<a.data_offset&&a.data_offset<this._superblk.eof_addr?(this.getMetadata("debug")&&console.log("loading "+a.data_length+" bytes from "+a.data_offset+" to "+a.name),a.array=this.getArray(a.type,a.data_length,a.data_offset)):this.getMetadata("debug")&&console.log("data not present for /"+a.name+"/");a.children.forEach(function(a){b.loadData(a)})};w.prototype.hdf5V1ObjectHeader=function(a){var b=this,c,d,e,f;this.startAlignment();
c=this.getU8();this.skip(1);d=this.getU16();e=this.getU32();f=this.getU32();if(1!==c)throw Error("Bad v1 object header version: "+c);this.getMetadata("debug")&&console.log("this.hdf5V1ObjectHeader V"+c+" #M "+d+" RC "+e+" HS "+f);e=f;var g;for(c=0;c<d;c+=1){if(8>=e)if(0!==this._continuation_queue.length)e=this._continuation_queue.shift(),this.seek(e.cq_off),e=e.cq_len,this.getMetadata("debug")&&console.log("continuing with "+e+" bytes at "+this.tell()),this.startAlignment();else break;this.checkAlignment();
f={};f.hm_type=this.getU16();f.hm_size=this.getU16();f.hm_flags=this.getU8();if(0!==f.hm_size%8)throw Error("Size is not 8-byte aligned: "+f.hm_size);this.skip(3);e-=8+f.hm_size;this.getMetadata("debug")&&console.log("  msg"+c+" F "+f.hm_flags+" T "+f.hm_type+" S "+f.hm_size+"("+e+") "+this.hdf5GetMsgName(f.hm_type));g=this.tell();this.hdf5ProcessMessage(f,a);this.seek(g+f.hm_size)}if(0!==a.sym_btree&&0!==a.sym_lheap){this.seek(a.sym_btree);d=this.hdf5V1BtreeNode();this.seek(a.sym_lheap);c=this.hdf5LocalHeap();
for(e=0;e<d.entries_used;e+=1)this.seek(d.keys[e].child_address),this.checkSignature("SNOD")?(this.seek(d.keys[e].child_address),this.hdf5GroupSymbolTable(c,a)):(this.seek(d.keys[e].child_address),this.hdf5V1ObjectHeader(a));a.children.forEach(function(a){b.seek(a.hdr_offset);b.hdf5V1ObjectHeader(a)})}};w.prototype.getTypeMatchMinc=function(a){return this._type_matching[a-1]};w.prototype.defined=function(a){return"undefined"!==typeof a};w.prototype.typeName=function(a){return this.defined(a)?a.constructor.name:
"undefined"};w.prototype.typeSize=function(a){if(a>=this._type_enum.INT8&&a<this.type_sizes.length)return this.type_sizes[a];throw Error("Unknown type "+a);};w.prototype.typeIsFloat=function(a){return a>=this._type_enum.FLT&&a<=this._type_enum.DBL};w.prototype.join=function(a,b){var c="";if(a&&a.length){var d;for(d=0;d<a.length-1;d+=1)c+=a[d],c+=b;c+=a[d]}return c};w.prototype.printStructure=function(a,b){var c=this,d,e="";for(d=0;d<2*b;d+=1)e+=" ";e+=a.name+(a.children.length?"/":"");0<a.type&&(e+=
" "+this.typeName(a.array),a.dims.length&&(e+="["+a.dims.join(", ")+"]"),e=a.array?e+(":"+a.array.length):e+" NULL");console.log(e);Object.keys(a.attributes).forEach(function(f){var g=a.attributes[f];e="";for(d=0;d<2*b+1;d+=1)e+=" ";e+=a.name+":"+f+" "+c.typeName(g)+"["+g.length+"] ";"string"===typeof g?e+=JSON.stringify(g):(e+="{"+c.join(g.slice(0,16),", "),16<g.length&&(e+=", ..."),e+="}");console.log(e)});a.children.forEach(function(a){c.printStructure(a,b+1)})};w.prototype.findDataset=function(a,
b,c){var d=this,e;a&&a.name===b&&0<a.type?e=a:a.children.find(function(a){e=d.findDataset(a,b,c+1);return d.defined(e)});return e};w.prototype.findAttribute=function(a,b,c){var d=this,e=a.attributes[b];if(e)return e;a.children.find(function(a){e=d.findAttribute(a,b,c+1);return d.defined(e)});return e};w.prototype.scaleVoxels=function(a,b,c,d,e){var f,g;switch(this.getTypeMatchMinc(a.type)){case "int8":f=new ArrayBuffer(a.array.length*Int8Array.BYTES_PER_ELEMENT);g=new Int8Array(f);break;case "int16":f=
new ArrayBuffer(a.array.length*Int16Array.BYTES_PER_ELEMENT);g=new Int16Array(f);break;case "int32":f=new ArrayBuffer(a.array.length*Int32Array.BYTES_PER_ELEMENT);g=new Int32Array(f);break;case "float32":f=new ArrayBuffer(a.array.length*Float32Array.BYTES_PER_ELEMENT);g=new Float32Array(f);break;case "float64":f=new ArrayBuffer(a.array.length*Float64Array.BYTES_PER_ELEMENT);g=new Float64Array(f);break;case "uint8":f=new ArrayBuffer(a.array.length*Uint8Array.BYTES_PER_ELEMENT);g=new Uint8Array(f);
break;case "uint16":f=new ArrayBuffer(a.array.length*Uint16Array.BYTES_PER_ELEMENT);g=new Uint16Array(f);break;case "uint32":f=new ArrayBuffer(a.array.length*Uint32Array.BYTES_PER_ELEMENT);g=new Uint32Array(f);break;default:throw b="Unsupported data type: "+header.datatype,console.log({message:b}),Error(b);}if(1>a.dims.length-b.dims.length)throw Error("Too few slice dimensions: "+a.dims.length+" "+b.dims.length);var k=1,h;for(h=b.dims.length;h<a.dims.length;h+=1)k*=a.dims[h];e&&console.log(k+" voxels in slice.");
var l=0,n=0,p=-Number.MAX_VALUE,t=Number.MAX_VALUE,q=a.array;c=c.array;var r=b.array;e&&console.log("valid range is "+d[0]+" to "+d[1]);var u,w=d[0],y,z,x,A=this.typeIsFloat(a.type);for(h=0;h<b.array.length;h+=1)if(e&&console.log(h+" "+r[h]+" "+c[h]+" "+q[h*k]),A)for(z=0;z<k;z+=1)x=q[n],x<d[0]||x>d[1]?g[n]=0:(g[n]=x,l+=x,x>p&&(p=x),x<t&&(t=x)),n+=1;else for(a=d[1]-d[0],u=c[h]-r[h],y=r[h],z=0;z<k;z+=1)x=(q[n]-w)/a*u+y,x=x/c[h]*d[1],g[n]=x,l+=x,n+=1,x>p&&(p=x),x<t&&(t=x);e&&(console.log("Min: "+t),
console.log("Max: "+p),console.log("Sum: "+l),console.log("Mean: "+l/n));return f};w.prototype.isRgbVolume=function(a,b){var c=a.order;return"Uint8Array"===b.array.constructor.name&&0<c.length&&"vector_dimension"===c[c.length-1]&&3===a.vector_dimension.space_length};w.prototype.rgbVoxels=function(a){a=a.array;var b=a.length,c=new ArrayBuffer(b/3*4),d=new Uint8Array(c),e,f=0;for(e=0;e<b;e+=3)d[f+0]=a[e+0],d[f+1]=a[e+1],d[f+2]=a[e+2],d[f+3]=255,f+=4;return c};w.prototype.parseHeader=function(a){var b;
try{b=JSON.parse(a)}catch(c){throw a="server did not respond with valid JSON\nResponse was: \n"+a,console.log({message:a}),Error(a);}4===b.order.length&&(b.order=b.order.slice(1));b.datatype=b.datatype||"uint8";b.xspace.space_length=parseFloat(b.xspace.space_length);b.yspace.space_length=parseFloat(b.yspace.space_length);b.zspace.space_length=parseFloat(b.zspace.space_length);b.xspace.start=parseFloat(b.xspace.start);b.yspace.start=parseFloat(b.yspace.start);b.zspace.start=parseFloat(b.zspace.start);
b.xspace.step=parseFloat(b.xspace.step);b.yspace.step=parseFloat(b.yspace.step);b.zspace.step=parseFloat(b.zspace.step);b.xspace.direction_cosines=b.xspace.direction_cosines||[1,0,0];b.yspace.direction_cosines=b.yspace.direction_cosines||[0,1,0];b.zspace.direction_cosines=b.zspace.direction_cosines||[0,0,1];b.xspace.direction_cosines=b.xspace.direction_cosines.map(parseFloat);b.yspace.direction_cosines=b.yspace.direction_cosines.map(parseFloat);b.zspace.direction_cosines=b.zspace.direction_cosines.map(parseFloat);
b[b.order[0]].offset=b[b.order[1]].space_length*b[b.order[2]].space_length;b[b.order[1]].offset=b[b.order[2]].space_length;b[b.order[2]].offset=1;b.time&&(b.time.space_length=parseFloat(b.time.space_length),b.time.start=parseFloat(b.time.start),b.time.step=parseFloat(b.time.step),b.time.offset=b.xspace.space_length*b.yspace.space_length*b.zspace.space_length);return b};w.prototype.createMincData=function(a,b){var c;switch(a.datatype){case "int8":c=new Int8Array(b);break;case "int16":c=new Int16Array(b);
break;case "int32":c=new Int32Array(b);break;case "float32":c=new Float32Array(b);break;case "float64":c=new Float64Array(b);break;case "uint8":c=new Uint8Array(b);break;case "uint16":c=new Uint16Array(b);break;case "uint32":case "rgb8":c=new Uint32Array(b);break;default:throw c="Unsupported data type: "+a.datatype,console.log({message:c}),Error(c);}return c};w.prototype._run=function(){var a=this,b=this._getInput(0);if(b){this._dv=new DataView(b);this._dv.getUint64=function(c,b){var d=a._dv.getUint32(c+
0,b),e=a._dv.getUint32(c+4,b);return b?(e<<32)+d:(d<<32)+e};var c=this.createLink();try{this._superblk=this.hdf5Superblock()}catch(m){console.warn("The input file is not a Minc2 file.");return}this.seek(this._superblk.root_addr);1>=this._superblk.sbver?this.hdf5V1ObjectHeader(c):this.hdf5V2ObjectHeader(c);this.loadData(c);this.getMetadata("debug")&&this.printStructure(c,0);b=this.findDataset(c,"image");if(!this.defined(b))throw Error("Can't find image dataset.");var d=this.findAttribute(b,"valid_range",
0);if(!this.defined(d)){var e,f;switch(b.type){case this._type_enum.INT8:e=-128;f=127;break;case this._type_enum.UINT8:e=0;f=255;break;case this._type_enum.INT16:e=-32768;f=32767;break;case this._type_enum.UINT16:e=0;f=65535;break;case this._type_enum.INT32:e=2147483648;f=-2147483649;break;case this._type_enum.UINT32:e=0,f=(1<<32)-1}d=Float32Array.of(e,f)}e=this.findDataset(c,"image-min");this.defined(e)||(e={array:Float32Array.of(0),dims:[]});f=this.findDataset(c,"image-max");this.defined(f)||(f=
{array:Float32Array.of(1),dims:[]});var g={},k=this.findAttribute(b,"dimorder",0);if("string"!==typeof k)throw Error("Can't find dimension order.");g.order=k.split(",");g.order.forEach(function(b){var d=a.findDataset(c,b);if(!a.defined(d))throw Error("Can't find dimension variable "+b);g[b]={};k=a.findAttribute(d,"step",0);a.defined(k)||(k=Float32Array.of(1));g[b].step=k[0];k=a.findAttribute(d,"start",0);a.defined(k)||(k=Float32Array.of(0));g[b].start=k[0];k=a.findAttribute(d,"length",0);if(!a.defined(k))throw Error("Can't find length for "+
b);g[b].space_length=k[0];k=a.findAttribute(d,"direction_cosines",0);a.defined(k)?g[b].direction_cosines=Array.prototype.slice.call(k):"xspace"===b?g[b].direction_cosines=[1,0,0]:"yspace"===b?g[b].direction_cosines=[0,1,0]:"zspace"===b&&(g[b].direction_cosines=[0,0,1])});this.isRgbVolume(g,b)?(g.order.pop(),g.datatype="rgb8",d=this.rgbVoxels(b)):(g.datatype=this.getTypeMatchMinc(b.type),d=this.scaleVoxels(b,e,f,d,this.getMetadata("debug")));b=this.parseHeader(JSON.stringify(g));d=this.createMincData(b,
d);this._addOutput(Q);e=this.getOutput();e.setData(d,b);e.setMetadata("format","minc2")}else console.warn('Minc2Decoder requires an ArrayBuffer as input "0". Unable to continue.')};var wa=function(){var a;a=A.call(this)||this;a.setMetadata("debug",!1);return a};$jscomp.inherits(wa,A);wa.prototype.parseNifti1Header=function(a){var b={order:["zspace","yspace","xspace"],xspace:{},yspace:{},zspace:{}},c=null,d=new DataView(a,0,348),e=new Uint8Array(a,0,348);a=!0;var f=d.getUint32(0,!0);348===f?a=!0:1543569408===
f?a=!1:c="This does not look like a NIfTI-1 file.";f=d.getUint16(40,a);if(3>f||4<f)c="Cannot handle "+f+"-dimensional images yet.";e=String.fromCharCode.apply(null,e.subarray(344,348));"n+1\x00"!==e&&(c="Bad magic number: '"+e+"'");if(c)return console.warn("The input file is not a NIfTI file."),null;b.xspace.space_length=d.getUint16(42,a);b.yspace.space_length=d.getUint16(44,a);b.zspace.space_length=d.getUint16(46,a);var g=d.getUint16(48,a),c=d.getUint16(70,a),k=d.getUint16(72,a),e=d.getFloat32(80,
a),f=d.getFloat32(84,a),h=d.getFloat32(88,a),l=d.getFloat32(92,a),n=d.getFloat32(108,a);352>n&&(n=352);var p=d.getFloat32(112,a),t=d.getFloat32(116,a),q=d.getUint16(252,a),r=d.getUint16(254,a),u=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];1<=g&&(b.time={},b.time.space_length=g,b.time.step=l,b.time.start=0,b.time.name="time",b.order=["time","zspace","yspace","xspace"]);b.bytes_per_voxel=k/8;b.must_swap_data=!a&&1<b.bytes_per_voxel;0<r?(u[0][0]=d.getFloat32(280,a),u[0][1]=d.getFloat32(284,a),u[0][2]=
d.getFloat32(288,a),u[0][3]=d.getFloat32(292,a),u[1][0]=d.getFloat32(296,a),u[1][1]=d.getFloat32(300,a),u[1][2]=d.getFloat32(304,a),u[1][3]=d.getFloat32(308,a),u[2][0]=d.getFloat32(312,a),u[2][1]=d.getFloat32(316,a),u[2][2]=d.getFloat32(320,a),u[2][3]=d.getFloat32(324,a)):0<q?(g=d.getFloat32(256,a),k=d.getFloat32(260,a),l=d.getFloat32(264,a),q=d.getFloat32(268,a),r=d.getFloat32(272,a),u=d.getFloat32(276,a),d=0>d.getFloat32(76,a)?-1:1,u=this.niftiQuaternToMat44(g,k,l,q,r,u,e,f,h,d)):(u[0][0]=e,u[1][1]=
f,u[2][2]=h);Q.transformToMinc(u,b);b.datatype=c;b.vox_offset=n;b.scl_slope=p;b.scl_inter=t;return b};wa.prototype.niftiQuaternToMat44=function(a,b,c,d,e,f,g,k,h,l){var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1]],m;m=1-(a*a+b*b+c*c);1E-7>m?(m=1/Math.sqrt(a*a+b*b+c*c),a*=m,b*=m,c*=m,m=0):m=Math.sqrt(m);g=0<g?g:1;k=0<k?k:1;h=0<h?h:1;0>l&&(h=-h);n[0][0]=(m*m+a*a-b*b-c*c)*g;n[0][1]=2*(a*b-m*c)*k;n[0][2]=2*(a*c+m*b)*h;n[1][0]=2*(a*b+m*c)*g;n[1][1]=(m*m+b*b-a*a-c*c)*k;n[1][2]=2*(b*c-m*a)*h;n[2][0]=2*(a*
c-m*b)*g;n[2][1]=2*(b*c+m*a)*k;n[2][2]=(m*m+c*c-b*b-a*a)*h;n[0][3]=d;n[1][3]=e;n[2][3]=f;return n};wa.prototype.createNifti1Data=function(a,b){var c;a.must_swap_data&&Q.swapn(new Uint8Array(b,a.vox_offset),a.bytes_per_voxel);switch(a.datatype){case 2:c=new Uint8Array(b,a.vox_offset);break;case 4:c=new Int16Array(b,a.vox_offset);break;case 8:c=new Int32Array(b,a.vox_offset);break;case 16:c=new Float32Array(b,a.vox_offset);break;case 64:c=new Float64Array(b,a.vox_offset);break;case 256:c=new Int8Array(b,
a.vox_offset);break;case 512:c=new Uint16Array(b,a.vox_offset);break;case 768:c=new Uint32Array(b,a.vox_offset);break;default:throw Error("Unsupported data type: "+a.datatype);}var d,e=a.scl_slope,f=a.scl_inter;if(0!==e){var g=new Float32Array(c.length);for(d=0;d<c.length;d++)g[d]=c[d]*e+f;c=g}4===a.order.length&&(a.order=a.order.slice(1));a[a.order[0]].offset=a[a.order[1]].space_length*a[a.order[2]].space_length;a[a.order[1]].offset=a[a.order[2]].space_length;a[a.order[2]].offset=1;a.time&&(a.time.offset=
a.xspace.space_length*a.yspace.space_length*a.zspace.space_length);return c};wa.prototype._run=function(){var a=this._getInput(0);if(a){var b=this.parseNifti1Header(a);if(b){a=this.createNifti1Data(b,a);this._addOutput(Q);var c=this.getOutput();c.setData(a,b);c.setMetadata("format","nifti")}}else console.warn('NiftiDecoder requires an ArrayBuffer as input "0". Unable to continue.')};var $c=Ta(function(a){var b=b||function(a){if(!("undefined"===typeof a||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var b=
a.document.createElementNS("http://www.w3.org/1999/xhtml","a"),c="download"in b,f=/constructor/i.test(a.HTMLElement)||a.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent),k=function(b){(a.setImmediate||a.setTimeout)(function(){throw b;},0)},h=function(b){setTimeout(function(){"string"===typeof b?(a.URL||a.webkitURL||a).revokeObjectURL(b):b.remove()},4E4)},l=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),
a],{type:a.type}):a},n=function(d,e,n){n||(d=l(d));var m=this,p="application/octet-stream"===d.type,q,r=function(){for(var a=["writestart","progress","write","writeend"],a=[].concat(a),b=a.length;b--;){var c=m["on"+a[b]];if("function"===typeof c)try{c.call(m,m)}catch(Rc){k(Rc)}}};m.readyState=m.INIT;c?(q=(a.URL||a.webkitURL||a).createObjectURL(d),setTimeout(function(){b.href=q;b.download=e;var a=new MouseEvent("click");b.dispatchEvent(a);r();h(q);m.readyState=m.DONE})):function(){if((g||p&&f)&&a.FileReader){var b=
new FileReader;b.onloadend=function(){var c=g?b.result:b.result.replace(/^data:[^;]*;/,"data:attachment/file;");a.open(c,"_blank")||(a.location.href=c);m.readyState=m.DONE;r()};b.readAsDataURL(d);m.readyState=m.INIT}else q||(q=(a.URL||a.webkitURL||a).createObjectURL(d)),p?a.location.href=q:a.open(q,"_blank")||(a.location.href=q),m.readyState=m.DONE,r(),h(q)}()},p=n.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(a,b,c){b=b||a.name||"download";c||(a=l(a));return navigator.msSaveOrOpenBlob(a,
b)};p.abort=function(){};p.readyState=p.INIT=0;p.WRITING=1;p.DONE=2;p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null;return function(a,b,c){return new n(a,b||a.name||"download",c)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||sb.content);a.exports&&(a.exports.saveAs=b)}),Qa=function(){var a;a=A.call(this)||this;a.setMetadata("filename","untitled.pixp");return a};$jscomp.inherits(Qa,A);Qa.prototype._hasValidInput=function(){var a=this._getInput();
return a&&(a.isOfType(C.TYPE())||a.isOfType(H.TYPE()))};Qa.prototype._run=function(){if(this.hasValidInput()){var a=this._getInput(),a={dataType:a.getData().constructor.name,data:Array.prototype.slice.call(a.getData()),metadata:a.getMetadataCopy(),pixpipeType:a.constructor.name},a=JSON.stringify(a),b=new va.Deflate({level:6,gzip:!0,header:{text:!0,time:+new Date,comment:"This file was created by Pixpipe.js"}});b.push(a,!0);this._output[0]=new Blob([b.result],{type:"application/gzip"})}else console.warn("PixpEncoder can only encode Image2D and Image3D.")};
Qa.prototype.download=function(){this.getOutput()?$c.saveAs(this.getOutput(),this.getMetadata("filename")):console.warn("No output computed yet.")};var Ra=function(){return A.call(this)||this};$jscomp.inherits(Ra,A);Ra.prototype._hasValidInput=function(){var a=this._getInput();return a&&a instanceof ArrayBuffer};Ra.prototype._run=function(){if(this.hasValidInput()){var a=this._getInput(),b=new va.Inflate({level:6,to:"string"});b.push(a,!0);if(b.err)console.warn("This file is not a Pixp file.");else{a=
null;try{a=JSON.parse(b.result)}catch(d){console.warn("Could not parse pixp file.");console.error(d);return}if(a.pixpipeType in pixpipe)if(b=window||this,b[a.dataType]){var b=new b[a.dataType](a.data),c=new pixpipe[a.pixpipeType];c.setRawData(b);c.setRawMetadata(a.metadata);this._output[0]=c}else console.warn("Data array from pixp file is unknown: "+a.dataType);else console.warn("Unknown type pixpipe."+a.pixpipeType+", cannot create any output.")}}else console.warn("PixpDecoder can only decode ArrayBuffer.")};
var vb=function(){var a;a=A.call(this)||this;a._decoders=[w,wa,Ra];return a};$jscomp.inherits(vb,A);vb.prototype._run=function(){var a=this._getInput(0);if(a)for(var b=0;b<this._decoders.length;b++){var c=new this._decoders[b];c.addInput(a);c.update();if(c.getNumberOfOutputs()){this._output[0]=c.getOutput();this.setMetadata("decoderConstructor",this._decoders[b]);this.setMetadata("decoderName",this._decoders[b].name);break}}else console.warn("The input buffer must not be null.")};var db=function(){return P.call(this)||
this};$jscomp.inherits(db,P);db.prototype._run=function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getWidth()*a.getHeight(),c=a.getDataCopy();this._forEachPixelOfSuch(c,0,b,1);this._addOutput(C).setData(c,a.getWidth(),a.getHeight(),a.getComponentsPerPixel())}};db.prototype._forEachPixelOfSuch=function(a,b,c,d){if("pixel"in this._events)for(var e=this._getInput(),f=e.getData(),g=e.getComponentsPerPixel(),k;b<c;b+=d){var h=b*g,l=e.get2dPositionFrom1dIndex(b);k=f.slice(h,h+g);if((k=this._events.pixel(l,
k))&&k.length==g)for(l=0;l<g;l++)a[h+l]=k[l]}else console.warn("No function to apply per pixel was specified.")};var wb=function(){var a;a=P.call(this)||this;a.addInputValidator(0,C);a.addInputValidator(1,C);return a};$jscomp.inherits(wb,P);wb.prototype._run=function(){if(this.hasValidInput()&&this.hasSameSizeInput()&&this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1);if(1!=b.getComponentsPerPixel())console.warn("The scaling image must have one single band.");else{for(var c=a.getWidth()*
a.getHeight(),d=a.getComponentsPerPixel(),e=a.getDataCopy(),b=b.getData(),f=0;f<c;f++)for(var g=0;g<d;g++)e[f*d+g]*=b[f];this._addOutput(C).setData(e,a.getWidth(),a.getHeight())}}};var bd=Ta(function(a,b){(function(b,d){a.exports=d()})(sb,function(){function a(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function b(a,b){this.type=a;this.value=void 0!==b&&null!==b?b:0}function e(a,b){this.tokens=a;this.parser=b;this.unaryOps=b.unaryOps;this.binaryOps=b.binaryOps;this.ternaryOps=b.ternaryOps;
this.functions=b.functions}function f(a){return"string"===typeof a?JSON.stringify(a).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):a}function g(a,c,d,e,f){for(var v=[],k=[],h,l,n,m,p=0,ad=a.length;p<ad;p++)if(m=a[p],h=m.type,"INUMBER"===h)v.push(m);else if("IVAR"===h&&f.hasOwnProperty(m.value))m=new b("INUMBER",f[m.value]),v.push(m);else if("IOP2"===h&&1<v.length)l=v.pop(),h=v.pop(),m=d[m.value],m=new b("INUMBER",m(h.value,l.value)),v.push(m);else if("IOP3"===h&&2<v.length)n=v.pop(),l=
v.pop(),h=v.pop(),"?"===m.value?v.push(h.value?l.value:n.value):(m=e[m.value],m=new b("INUMBER",m(h.value,l.value,n.value)),v.push(m));else if("IOP1"===h&&0<v.length)h=v.pop(),m=c[m.value],m=new b("INUMBER",m(h.value)),v.push(m);else if("IEXPR"===h){for(;0<v.length;)k.push(v.shift());k.push(new b("IEXPR",g(m.value,c,d,e,f)))}else if("IMEMBER"===h&&0<v.length)h=v.pop(),v.push(new b("INUMBER",h.value[m.value]));else{for(;0<v.length;)k.push(v.shift());k.push(m)}for(;0<v.length;)k.push(v.shift());return k}
function k(a,c,d){for(var e=[],f=0,g=a.length;f<g;f++){var v=a[f],h=v.type;if("IVAR"===h&&v.value===c)for(v=0;v<d.tokens.length;v++)h=d.tokens[v],h="IOP1"===h.type?Y(h.value):"IOP2"===h.type?N(h.value):"IOP3"===h.type?da(h.value):new b(h.type,h.value),e.push(h);else"IEXPR"===h?e.push(new b("IEXPR",k(v.value,c,d))):e.push(v)}return e}function h(a,b,c){for(var d=[],e,f,g,v,k=0,l=a.length;k<l;k++)if(v=a[k],e=v.type,"INUMBER"===e)d.push(v.value);else if("IOP2"===e)f=d.pop(),e=d.pop(),v=b.binaryOps[v.value],
d.push(v(e,f));else if("IOP3"===e)g=d.pop(),f=d.pop(),e=d.pop(),"?"===v.value?d.push(h(e?f:g,b,c)):(v=b.ternaryOps[v.value],d.push(v(e,f,g)));else if("IVAR"===e)if(v.value in b.functions)d.push(b.functions[v.value]);else if(e=c[v.value],void 0!==e)d.push(e);else throw Error("undefined variable: "+v.value);else if("IOP1"===e)e=d.pop(),v=b.unaryOps[v.value],d.push(v(e));else if("IFUNCALL"===e){v=v.value;for(e=[];0<v--;)e.unshift(d.pop());v=d.pop();if(v.apply&&v.call)d.push(v.apply(void 0,e));else throw Error(v+
" is not a function");}else if("IEXPR"===e)d.push(v.value);else if("IMEMBER"===e)e=d.pop(),d.push(e[v.value]);else throw Error("invalid Expression");if(1<d.length)throw Error("invalid Expression (parity)");return d[0]}function l(a,b){for(var c=[],d,e,g,v,k=0,h=a.length;k<h;k++)if(v=a[k],d=v.type,"INUMBER"===d)"number"===typeof v.value&&0>v.value?c.push("("+v.value+")"):c.push(f(v.value));else if("IOP2"===d)e=c.pop(),d=c.pop(),v=v.value,b?"^"===v?c.push("Math.pow("+d+", "+e+")"):"and"===v?c.push("(!!"+
d+" && !!"+e+")"):"or"===v?c.push("(!!"+d+" || !!"+e+")"):"||"===v?c.push("(String("+d+") + String("+e+"))"):"=="===v?c.push("("+d+" === "+e+")"):"!="===v?c.push("("+d+" !== "+e+")"):c.push("("+d+" "+v+" "+e+")"):c.push("("+d+" "+v+" "+e+")");else if("IOP3"===d)if(g=c.pop(),e=c.pop(),d=c.pop(),v=v.value,"?"===v)c.push("("+d+" ? "+e+" : "+g+")");else throw Error("invalid Expression");else if("IVAR"===d)c.push(v.value);else if("IOP1"===d)d=c.pop(),v=v.value,"-"===v||"+"===v?c.push("("+v+d+")"):b?"not"===
v?c.push("(!"+d+")"):"!"===v?c.push("fac("+d+")"):c.push(v+"("+d+")"):"!"===v?c.push("("+d+"!)"):c.push("("+v+" "+d+")");else if("IFUNCALL"===d){e=v.value;for(d=[];0<e--;)d.unshift(c.pop());v=c.pop();c.push(v+"("+d.join(", ")+")")}else if("IMEMBER"===d)d=c.pop(),c.push(d+"."+v.value);else if("IEXPR"===d)c.push("("+l(v.value,b)+")");else throw Error("invalid Expression");if(1<c.length)throw Error("invalid Expression (parity)");return c[0]}function n(b,c){for(var d=0,e=b.length;d<e;d++){var f=b[d];
"IVAR"===f.type&&-1===a(c,f.value)?c.push(f.value):"IEXPR"===f.type&&n(f.value,c)}}function p(a,b){return Number(a)+Number(b)}function t(a,b){return a-b}function q(a,b){return a*b}function r(a,b){return a/b}function u(a,b){return a%b}function w(a,b){return""+a+b}function x(a,b){return a===b}function y(a,b){return a!==b}function z(a,b){return a>b}function A(a,b){return a<b}function B(a,b){return a>=b}function C(a,b){return a<=b}function D(a,b){return!(!a||!b)}function E(a,b){return!(!a&&!b)}function G(a){return(Math.exp(a)-
Math.exp(-a))/2}function H(a){return(Math.exp(a)+Math.exp(-a))/2}function I(a){return Infinity===a?1:-Infinity===a?-1:(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))}function F(a){return-Infinity===a?a:Math.log(a+Math.sqrt(a*a+1))}function J(a){return Math.log(a+Math.sqrt(a*a-1))}function K(a){return Math.log((1+a)/(1-a))/2}function L(a){return Math.log(a)*Math.LOG10E}function O(a){return-a}function S(a){return!a}function T(a){return 0>a?Math.ceil(a):Math.floor(a)}function U(a){return Math.random()*
(a||1)}function P(a){return W(a+1)}function aa(a){return String(a).length}function X(){for(var a=0,b=0,c=0,d=arguments.length;c<d;c++){var e=Math.abs(arguments[c]),f;b<e?(f=b/e,a=a*f*f+1,b=e):0<e?(f=e/b,a+=f*f):a+=e}return Infinity===b?Infinity:b*Math.sqrt(a)}function Z(a,b,c){return a?b:c}function W(a){var b,c;c=a;if(isFinite(c)&&c===Math.round(c)){if(0>=a)return isFinite(a)?Infinity:NaN;if(171<a)return Infinity;c=a-2;for(--a;1<c;)a*=c,c--;0===a&&(a=1);return a}if(.5>a)return Math.PI/(Math.sin(Math.PI*
a)*W(1-a));if(171.35<=a)return Infinity;if(85<a){c=a*a;b=c*a;var d=b*a,e=d*a;return Math.sqrt(2*Math.PI/a)*Math.pow(a/Math.E,a)*(1+1/(12*a)+1/(288*c)-139/(51840*b)-571/(2488320*d)+163879/(209018880*e)+5246819/(75246796800*e*a))}--a;c=ca[0];for(b=1;b<ca.length;++b)c+=ca[b]/(a+b);b=a+ga+.5;return Math.sqrt(2*Math.PI)*Math.pow(b,a+.5)*Math.exp(-b)*c}function ba(a,b,c,d){this.type=a;this.value=b;this.line=c;this.column=d}function R(a,b,c,d,e){this.column=this.line=this.pos=0;this.current=null;this.unaryOps=
b;this.binaryOps=c;this.ternaryOps=d;this.consts=e;this.expression=a;this.savedPosition=0;this.savedCurrent=null;this.savedColumn=this.savedLine=0}function Y(a){var c=ea[a];c||(c=ea[a]=new b("IOP1",a));return c}function N(a){var c=fa[a];c||(c=fa[a]=new b("IOP2",a));return c}function da(a){var c=ha[a];c||(c=ha[a]=new b("IOP3",a));return c}function M(a,b){this.parser=a;this.tokens=b;this.nextToken=this.current=null;this.next();this.savedNextToken=this.savedCurrent=null}function Q(){this.unaryOps={sin:Math.sin,
cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||G,cosh:Math.cosh||H,tanh:Math.tanh||I,asinh:Math.asinh||F,acosh:Math.acosh||J,atanh:Math.atanh||K,sqrt:Math.sqrt,log:Math.log,ln:Math.log,lg:Math.log10||L,log10:Math.log10||L,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||T,"-":O,"+":Number,exp:Math.exp,not:S,length:aa,"!":P};this.binaryOps={"+":p,"-":t,"*":q,"/":r,"%":u,"^":Math.pow,"||":w,"==":x,"!=":y,">":z,"<":A,">=":B,"<=":C,
and:D,or:E};this.ternaryOps={"?":Z};this.functions={random:U,fac:P,min:Math.min,max:Math.max,hypot:Math.hypot||X,pyt:Math.hypot||X,pow:Math.pow,atan2:Math.atan2,"if":Z,gamma:W};this.consts={E:Math.E,PI:Math.PI,"true":!0,"false":!1}}b.prototype.toString=function(){switch(this.type){case "INUMBER":case "IOP1":case "IOP2":case "IOP3":case "IVAR":return this.value;case "IFUNCALL":return"CALL "+this.value;case "IMEMBER":return"."+this.value;default:return"Invalid Instruction"}};e.prototype.simplify=function(a){a=
a||{};return new e(g(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,a),this.parser)};e.prototype.substitute=function(a,b){b instanceof e||(b=this.parser.parse(String(b)));return new e(k(this.tokens,a,b),this.parser)};e.prototype.evaluate=function(a){a=a||{};return h(this.tokens,this,a)};e.prototype.toString=function(){return l(this.tokens,!1)};e.prototype.symbols=function(){var a=[];n(this.tokens,a);return a};e.prototype.variables=function(){var a=[];n(this.tokens,a);var b=this.functions;
return a.filter(function(a){return!(a in b)})};e.prototype.toJSFunction=function(a,b){var c=this,d=new Function(a,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+l(this.simplify(b).tokens,!0)+"; }");return function(){return d.apply(c,arguments)}};var ga=4.7421875,ca=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3.399464998481189E-5,4.652362892704858E-5,-9.837447530487956E-5,1.580887032249125E-4,-2.1026444172410488E-4,
2.1743961811521265E-4,-1.643181065367639E-4,8.441822398385275E-5,-2.6190838401581408E-5,3.6899182659531625E-6];ba.prototype.toString=function(){return this.type+": "+this.value};R.prototype.newToken=function(a,b,c,d){return new ba(a,b,null!=c?c:this.line,null!=d?d:this.column)};R.prototype.save=function(){this.savedPosition=this.pos;this.savedCurrent=this.current;this.savedLine=this.line;this.savedColumn=this.column};R.prototype.restore=function(){this.pos=this.savedPosition;this.current=this.savedCurrent;
this.line=this.savedLine;this.column=this.savedColumn};R.prototype.next=function(){if(this.pos>=this.expression.length)return this.newToken("TEOF","EOF");if(this.isWhitespace()||this.isComment())return this.next();if(this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName())return this.current;this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')};R.prototype.isString=function(){var a=!1,b=this.line,c=
this.column,d=this.pos,e=this.expression.charAt(d);if("'"===e||'"'===e){this.pos++;this.column++;for(var f=this.expression.indexOf(e,d+1);0<=f&&this.pos<this.expression.length;){this.pos=f+1;if("\\"!==this.expression.charAt(f-1)){a=this.expression.substring(d+1,f);this.current=this.newToken("TSTRING",this.unescape(a),b,c);b=a.indexOf("\n");for(c=-1;0<=b;)this.line++,this.column=0,c=b,b=a.indexOf("\n",b+1);this.column+=a.length-c;a=!0;break}f=this.expression.indexOf(e,f+1)}}return a};R.prototype.isParen=
function(){var a=this.expression.charAt(this.pos);return"("===a||")"===a?(this.current=this.newToken("TPAREN",a),this.pos++,this.column++,!0):!1};R.prototype.isComma=function(){return","===this.expression.charAt(this.pos)?(this.current=this.newToken("TCOMMA",","),this.pos++,this.column++,!0):!1};R.prototype.isConst=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&"."!==c&&("0">c||"9"<c)))break}return b>
a&&(a=this.expression.substring(a,b),a in this.consts)?(this.current=this.newToken("TNUMBER",this.consts[a]),this.pos+=a.length,this.column+=a.length,!0):!1};R.prototype.isNamedOp=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&("0">c||"9"<c)))break}return b>a&&(a=this.expression.substring(a,b),a in this.binaryOps||a in this.unaryOps||a in this.ternaryOps)?(this.current=this.newToken("TOP",
a),this.pos+=a.length,this.column+=a.length,!0):!1};R.prototype.isName=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&("0">c||"9"<c)))break}return b>a?(a=this.expression.substring(a,b),this.current=this.newToken("TNAME",a),this.pos+=a.length,this.column+=a.length,!0):!1};R.prototype.isWhitespace=function(){for(var a=!1,b=this.expression.charAt(this.pos);" "===b||"\t"===b||"\n"===b||"\r"===
b;){a=!0;this.pos++;this.column++;"\n"===b&&(this.line++,this.column=0);if(this.pos>=this.expression.length)break;b=this.expression.charAt(this.pos)}return a};var ia=/^[0-9a-f]{4}$/i;R.prototype.unescape=function(a){var b=a.indexOf("\\");if(0>b)return a;for(var c=a.substring(0,b);0<=b;){var d=a.charAt(++b);switch(d){case "'":c+="'";break;case '"':c+='"';break;case "\\":c+="\\";break;case "/":c+="/";break;case "b":c+="\b";break;case "f":c+="\f";break;case "n":c+="\n";break;case "r":c+="\r";break;case "t":c+=
"\t";break;case "u":d=a.substring(b+1,b+5);ia.test(d)||this.parseError("Illegal escape sequence: \\u"+d);c+=String.fromCharCode(parseInt(d,16));b+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+d+'"');}++b;d=a.indexOf("\\",b);c+=a.substring(b,0>d?a.length:d);b=d}return c};R.prototype.isComment=function(){if("/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)){var a=this.pos;this.pos=this.expression.indexOf("*/",this.pos)+2;1===this.pos&&(this.pos=
this.expression.length);for(var a=this.expression.substring(a,this.pos),b=a.indexOf("\n");0<=b;)this.line++,this.column=a.length-b,b=a.indexOf("\n",b+1);return!0}return!1};R.prototype.isNumber=function(){for(var a=!1,b=this.pos,c=b,d=b,e=this.column,f=e,g=!1,k=!1,h;b<this.expression.length;)if(h=this.expression.charAt(b),"0"<=h&&"9">=h||!g&&"."===h)"."===h?g=!0:k=!0,b++,e++,a=k;else break;a&&(d=b,f=e);if("e"===h||"E"===h){b++;e++;g=!0;for(k=!1;b<this.expression.length;){h=this.expression.charAt(b);
if(!g||"+"!==h&&"-"!==h)if("0"<=h&&"9">=h)k=!0,g=!1;else break;else g=!1;b++;e++}k||(b=d,e=f)}a?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(c,b))),this.pos=b,this.column=e):(this.pos=d,this.column=f);return a};R.prototype.isOperator=function(){var a=this.expression.charAt(this.pos);if("+"===a||"-"===a||"*"===a||"/"===a||"%"===a||"^"===a||"?"===a||":"===a||"."===a)this.current=this.newToken("TOP",a);else if("\u2219"===a||"\u2022"===a)this.current=this.newToken("TOP",
"*");else if(">"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP",">="),this.pos++,this.column++):this.current=this.newToken("TOP",">");else if("<"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP","<="),this.pos++,this.column++):this.current=this.newToken("TOP","<");else if("|"===a)if("|"===this.expression.charAt(this.pos+1))this.current=this.newToken("TOP","||"),this.pos++,this.column++;else return!1;else if("="===a)if("="===this.expression.charAt(this.pos+
1))this.current=this.newToken("TOP","=="),this.pos++,this.column++;else return!1;else if("!"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP","!="),this.pos++,this.column++):this.current=this.newToken("TOP",a);else return!1;this.pos++;this.column++;return!0};R.prototype.parseError=function(a){throw Error("parse error ["+(this.line+1)+":"+(this.column+1)+"]: "+a);};var ea={},fa={},ha={};M.prototype.next=function(){this.current=this.nextToken;return this.nextToken=this.tokens.next()};
M.prototype.tokenMatches=function(b,c){return"undefined"===typeof c?!0:Array.isArray(c)?0<=a(c,b.value):"function"===typeof c?c(b):b.value===c};M.prototype.save=function(){this.savedCurrent=this.current;this.savedNextToken=this.nextToken;this.tokens.save()};M.prototype.restore=function(){this.tokens.restore();this.current=this.savedCurrent;this.nextToken=this.savedNextToken};M.prototype.accept=function(a,b){return this.nextToken.type===a&&this.tokenMatches(this.nextToken,b)?(this.next(),!0):!1};M.prototype.expect=
function(a,b){if(!this.accept(a,b))throw Error("parse error ["+this.tokens.line+":"+this.tokens.column+"]: Expected "+(b||a));};M.prototype.parseAtom=function(a){if(this.accept("TNAME"))a.push(new b("IVAR",this.current.value));else if(this.accept("TNUMBER"))a.push(new b("INUMBER",this.current.value));else if(this.accept("TSTRING"))a.push(new b("INUMBER",this.current.value));else if(this.accept("TPAREN","("))this.parseExpression(a),this.expect("TPAREN",")");else throw Error("unexpected "+this.nextToken);
};M.prototype.parseExpression=function(a){this.parseConditionalExpression(a)};M.prototype.parseConditionalExpression=function(a){for(this.parseOrExpression(a);this.accept("TOP","?");){var c=[],d=[];this.parseConditionalExpression(c);this.expect("TOP",":");this.parseConditionalExpression(d);a.push(new b("IEXPR",c));a.push(new b("IEXPR",d));a.push(da("?"))}};M.prototype.parseOrExpression=function(a){for(this.parseAndExpression(a);this.accept("TOP","or");)this.parseAndExpression(a),a.push(N("or"))};
M.prototype.parseAndExpression=function(a){for(this.parseComparison(a);this.accept("TOP","and");)this.parseComparison(a),a.push(N("and"))};M.prototype.parseComparison=function(a){for(this.parseAddSub(a);this.accept("TOP","== != < <= >= >".split(" "));){var b=this.current;this.parseAddSub(a);a.push(N(b.value))}};M.prototype.parseAddSub=function(a){for(this.parseTerm(a);this.accept("TOP",["+","-","||"]);){var b=this.current;this.parseTerm(a);a.push(N(b.value))}};M.prototype.parseTerm=function(a){for(this.parseFactor(a);this.accept("TOP",
["*","/","%"]);){var b=this.current;this.parseFactor(a);a.push(N(b.value))}};M.prototype.parseFactor=function(a){var b=this.tokens.unaryOps;this.save();if(this.accept("TOP",function(a){return a.value in b}))if("-"!==this.current.value&&"+"!==this.current.value&&"TPAREN"===this.nextToken.type&&"("===this.nextToken.value)this.restore(),this.parseExponential(a);else{var c=this.current;this.parseFactor(a);a.push(Y(c.value))}else this.parseExponential(a)};M.prototype.parseExponential=function(a){for(this.parsePostfixExpression(a);this.accept("TOP",
"^");)this.parseFactor(a),a.push(N("^"))};M.prototype.parsePostfixExpression=function(a){for(this.parseFunctionCall(a);this.accept("TOP","!");)a.push(Y("!"))};M.prototype.parseFunctionCall=function(a){var c=this.tokens.unaryOps;if(this.accept("TOP",function(a){return a.value in c})){var d=this.current;this.parseAtom(a);a.push(Y(d.value))}else for(this.parseMemberExpression(a);this.accept("TPAREN","(");)this.accept("TPAREN",")")?a.push(new b("IFUNCALL",0)):(d=this.parseArgumentList(a),a.push(new b("IFUNCALL",
d)))};M.prototype.parseArgumentList=function(a){for(var b=0;!this.accept("TPAREN",")");)for(this.parseExpression(a),++b;this.accept("TCOMMA");)this.parseExpression(a),++b;return b};M.prototype.parseMemberExpression=function(a){for(this.parseAtom(a);this.accept("TOP",".");)this.expect("TNAME"),a.push(new b("IMEMBER",this.current.value))};Q.parse=function(a){return(new Q).parse(a)};Q.evaluate=function(a,b){return Q.parse(a).evaluate(b)};Q.prototype={parse:function(a){var b=[];a=new M(this,new R(a,this.unaryOps,
this.binaryOps,this.ternaryOps,this.consts));a.parseExpression(b);a.expect("TEOF","EOF");return new e(b,this)},evaluate:function(a,b){return this.parse(a).evaluate(b)}};return{Parser:Q,Expression:e}})}),xb=function(){return P.call(this)||this};$jscomp.inherits(xb,P);xb.prototype._run=function(){if(!this.hasMetadata("expression"))console.warn('A filter of type ImageBlendExpressionFilter requires a blending expression.\nUse \'setMetadata("expression", "...")\' to set it.');else if(this.hasSameNcppInput()&&
this.hasSameSizeInput())if(this.getNumberOfInputs()){for(var a=this.getInputCategories(),b=this._getInput(a[0]),c=b.getDataCopy(),d=(new bd.Parser).parse(this.getMetadata("expression")),e=0;e<c.length;e++){for(var f={},g=0;g<a.length;g++)f[a[g]]=this._getInput(a[g]).getData()[e];c[e]=d.evaluate(f)}this._addOutput(C).setData(c,b.getWidth(),b.getHeight())}else console.warn("A filter of type ImageBlendExpressionFilter requires at least one input.")};var yb=function(){var a;a=P.call(this)||this;a.addInputValidator(0,
C);a.addInputValidator(1,C);return a};$jscomp.inherits(yb,P);yb.prototype._run=function(){if(!this.hasValidInput())console.warn("A filter of type MultiplyImageFilter requires 1 input of category '0' and one input of category '1'.");else if(this.hasSameNcppInput()&&this.hasSameSizeInput()){this.addTimeRecord("step1");var a=this._getInput(0),b=this._getInput(1).getData();this.addTimeRecord("step1.5");var c=a.getDataCopy();this.addTimeRecord("step2");for(var d=0;d<c.length;d++)c[d]*=b[d];this.addTimeRecord("step3");
this._addOutput(C).setData(c,a.getWidth(),a.getHeight());this.addTimeRecord("step4");this.getTime("step1","step1.5",!0);this.getTime("step1.5","step2",!0);this.getTime("step2","step3",!0);this.getTime("step3","step4",!0)}};var zb=function(){var a;a=P.call(this)||this;a.setMetadata("threshold",128);a.setMetadata("lowValue",0);a.setMetadata("highValue",255);a.setMetadata("preserveAlpha",!0);return a};$jscomp.inherits(zb,P);zb.prototype._run=function(){if(this.hasValidInput()){var a=this._getInput(0),
b=a.clone(),c=a.getComponentsPerPixel(),a=this.getMetadata("threshold"),d=this.getMetadata("lowValue"),e=this.getMetadata("highValue"),f=b.getData();if(1==c||3==c||4==c){if(this.getMetadata("preserveAlpha")&&4==c)for(c=0;c<f.length;c++)3!=c%4&&(f[c]=f[c]<a?d:e);else for(c=0;c<f.length;c++)f[c]=f[c]<a?d:e;this._output[0]=b}else console.warn("The input data must have 1, 3 or 4 components per pixel.")}};var Ab=function(){var a;a=A.call(this)||this;a.addInputValidator(0,H);a.setMetadata("maxWidth",4096);
a.setMetadata("maxHeight",4096);a.setMetadata("axis","xspace");return a};$jscomp.inherits(Ab,A);Ab.prototype._run=function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getMetadata(this.getMetadata("axis"));if(b){var c=b.space_length,d=b.width,b=b.height,e=Math.floor(this.getMetadata("maxWidth")/d),f=Math.floor(this.getMetadata("maxHeight")/b),g=e*d,h=f*b,f=e*f;1==Math.ceil(c/f)&&(h=Math.ceil(c/e)*b);this.setMetadata("gridWidth",g/d);this.setMetadata("gridHeight",h/b);for(var m=0,l=0,n=0,
p=null;l<c;l++){var t=a.getSlice(this.getMetadata("axis"),l);0==l%f&&(p=new C({width:g,height:h,color:[0]}),this._output[m]=p,n=0,m++);var q=n%e,r=Math.floor(n/e);n++;for(var q=q*d,r=r*b,u=0;u<b;u++)for(var w=0;w<d;w++)p.setPixel({x:q+w,y:r+u},t.getPixel({x:w,y:u}))}}else console.warn("Sampling axis for mosaicing was not poperly set. Has to be 'xspace', 'yspace' or 'zspace'.")}};h.PixpipeObject=E;h.Filter=A;h.Image2D=C;h.Image3D=H;h.ImageToImageFilter=P;h.MniVolume=Q;h.CanvasImageWriter=Ka;h.UrlImageReader=
ab;h.FileImageReader=bb;h.FileToArrayBufferReader=Pa;h.UrlToArrayBufferReader=cb;h.Minc2Decoder=w;h.NiftiDecoder=wa;h.PixpEncoder=Qa;h.PixpDecoder=Ra;h.Image3DGenericDecoder=vb;h.ForEachPixelImageFilter=db;h.SpectralScaleImageFilter=wb;h.ImageBlendExpressionFilter=xb;h.MultiplyImageFilter=yb;h.SimpleThresholdFilter=zb;h.Image3DToMosaicFilter=Ab;Object.defineProperty(h,"__esModule",{value:!0})});
